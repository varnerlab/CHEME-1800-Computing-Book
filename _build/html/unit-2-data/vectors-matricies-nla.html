
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Vectors, Matrices and Linear Algebraic Equations &#8212; CHEME 1800/4800</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="canonical" href="https://varnerlab.github.io/CHEME-1800-Computing-Book/landing.html/unit-2-data/vectors-matricies-nla.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Dimensionality Reduction" href="reduction.html" />
    <link rel="prev" title="Data Structures" href="trees.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-VQRVBL1C02"></script>
<script>
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){ dataLayer.push(arguments); }
                    gtag('js', new Date());
                    gtag('config', 'G-VQRVBL1C02');
                </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/cornell_seal_simple_black.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">CHEME 1800/4800</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../landing.html">
                    Principles of Computational Thinking for Engineers
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../unit-1-basics/basics-landing.html">
   Unit 1. Basics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../unit-1-basics/types.html">
     Expressions, Variables and Types
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../unit-1-basics/functions.html">
     Functions, Control Statements, and Recursion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../unit-1-basics/programs.html">
     Programs and Modules
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../unit-1-basics/data-file-io.html">
     Data Input and Output
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="data-landing.html">
   Unit 2. Data
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="trees.html">
     Data Structures
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Vectors, Matrices and Linear Algebraic Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="reduction.html">
     Dimensionality Reduction
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../unit-3-learning/learning-landing.html">
   Unit 3. Learning
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../unit-3-learning/penalty.html">
     Ordinary Least Squares Problems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../unit-3-learning/lp.html">
     Linear Programming
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../unit-3-learning/combitorial.html">
     Dynamic Progamming and Heuristic Optimization
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../unit-4-decisions/decisions-landing.html">
   Unit 4. Decisions
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../unit-4-decisions/simple.html">
     Probability and Simple Decisions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../unit-4-decisions/mdp.html">
     Markov Decision Processes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../unit-4-decisions/multi-arm-bandits.html">
     Multiple Arm Bandit Problems and Reinforcement Learning
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../References.html">
   References
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/varnerlab/CHEME-1800-Computing-Book/main?urlpath=tree/unit-2-data/vectors-matricies-nla.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/varnerlab/CHEME-1800-Computing-Book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/varnerlab/CHEME-1800-Computing-Book/issues/new?title=Issue%20on%20page%20%2Funit-2-data/vectors-matricies-nla.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/unit-2-data/vectors-matricies-nla.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download notebook file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        <a href="../_sources/unit-2-data/vectors-matricies-nla.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#review-of-balances">
   Review of balances
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#open-species-mass-balances">
     Open species mass balances
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#open-species-mole-balances">
     Open species mole balances
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#motivation-matrix-vector-notation-mole-balances">
     Motivation: Matrix-vector notation mole balances
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#matricies-and-vectors">
   Matricies and Vectors
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#special-matrices-and-matrix-properties">
     Special matrices and matrix properties
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trace-determinant-lu-decomposition-and-rank">
       Trace, Determinant, LU decomposition and Rank
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#trace">
         Trace
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#determinant">
         Determinant
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#lu-decomposition">
         LU decomposition
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#rank">
         Rank
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mathematical-matrix-and-vector-operations">
   Mathematical matrix and vector operations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#addition-and-subtraction">
     Addition and subtraction
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#is-the-naive-approach-really-the-best">
       Is the naive approach really the best?
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#additional-information-on-vectorization">
         Additional information on vectorization
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multiplication-operations">
     Multiplication operations
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#scalar-multiplication">
       Scalar multiplication
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#vector-vector-operations">
       Vector-vector operations
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#right-multiplication-of-a-matrix-by-a-vector">
       Right multiplication of a matrix by a vector
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#left-multiplication-of-a-matrix-by-a-vector">
       Left multiplication of a matrix by a vector
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#matrix-matrix-products">
       Matrix-Matrix products
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#linear-algebraic-equations">
   Linear algebraic equations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#existence">
     Existence
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#homogeneous-square-systems">
       Homogeneous square systems
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#non-homogeneous-square-systems">
       Non-homogeneous square systems
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solutions-approaches">
     Solutions approaches
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#gaussian-elimination">
       Gaussian elimination
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#triangular-systems">
         Triangular systems
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#row-reduction-approaches">
         Row reduction approaches
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#iterative-solution-methods">
       Iterative solution methods
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#jacobi-s-method">
         Jacobi’s method
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#gauss-seidel-method">
         Gauss-Seidel method
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#successive-overrelaxation">
         Successive Overrelaxation
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#convergence-of-iterative-methods">
       Convergence of iterative methods
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#additonal-resources">
   Additonal resources
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Vectors, Matrices and Linear Algebraic Equations</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#review-of-balances">
   Review of balances
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#open-species-mass-balances">
     Open species mass balances
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#open-species-mole-balances">
     Open species mole balances
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#motivation-matrix-vector-notation-mole-balances">
     Motivation: Matrix-vector notation mole balances
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#matricies-and-vectors">
   Matricies and Vectors
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#special-matrices-and-matrix-properties">
     Special matrices and matrix properties
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trace-determinant-lu-decomposition-and-rank">
       Trace, Determinant, LU decomposition and Rank
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#trace">
         Trace
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#determinant">
         Determinant
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#lu-decomposition">
         LU decomposition
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#rank">
         Rank
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mathematical-matrix-and-vector-operations">
   Mathematical matrix and vector operations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#addition-and-subtraction">
     Addition and subtraction
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#is-the-naive-approach-really-the-best">
       Is the naive approach really the best?
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#additional-information-on-vectorization">
         Additional information on vectorization
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multiplication-operations">
     Multiplication operations
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#scalar-multiplication">
       Scalar multiplication
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#vector-vector-operations">
       Vector-vector operations
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#right-multiplication-of-a-matrix-by-a-vector">
       Right multiplication of a matrix by a vector
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#left-multiplication-of-a-matrix-by-a-vector">
       Left multiplication of a matrix by a vector
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#matrix-matrix-products">
       Matrix-Matrix products
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#linear-algebraic-equations">
   Linear algebraic equations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#existence">
     Existence
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#homogeneous-square-systems">
       Homogeneous square systems
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#non-homogeneous-square-systems">
       Non-homogeneous square systems
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solutions-approaches">
     Solutions approaches
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#gaussian-elimination">
       Gaussian elimination
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#triangular-systems">
         Triangular systems
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#row-reduction-approaches">
         Row reduction approaches
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#iterative-solution-methods">
       Iterative solution methods
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#jacobi-s-method">
         Jacobi’s method
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#gauss-seidel-method">
         Gauss-Seidel method
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#successive-overrelaxation">
         Successive Overrelaxation
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#convergence-of-iterative-methods">
       Convergence of iterative methods
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#additonal-resources">
   Additonal resources
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="vectors-matrices-and-linear-algebraic-equations">
<h1>Vectors, Matrices and Linear Algebraic Equations<a class="headerlink" href="#vectors-matrices-and-linear-algebraic-equations" title="Permalink to this headline">#</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h2>
<p>This lecture will introduce Vectors, Matrices, and operations defined on these objects. Vectors and matrices are widely used in computer science, engineering, and other fields where mathematical modeling is essential. In chemical engineering, vectors and matrcies are used to represent physical laws such as the conservation of mass, moles or energy.</p>
<p>Thus, we begin our discussion of vectors, matrcies and their associated operations by quickly reviewing mass and mole balance equations:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#content-references-matrix-vector-mass-mol-balances"><span class="std std-ref">Review of balances</span></a>. Chemical Engineers use balance equations to describe, design, and troubleshoot products and processes. Balance equations describe the amount of <em>stuff</em> (e.g., mass, moles, energy, etc.) in a <em>system</em> that interacts with its <em>surroundings</em>. Balance equations can be represented as a system of matrices and vectors.</p></li>
</ul>
<p>Next, we transition to defining the structure of matrices and vectors, and thier associated operations:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#content-references-matrix-vector"><span class="std std-ref">Matricies and Vectors</span></a> are abstract mathematical objects, typically arrays of numbers, in engineering applications. Vectors (one-dimensional arrays) often describe points in space or encode coefficients of linear equations. On the other hand, matrices (two- or more dimensional objects) typically represent data sets or a grid of numbers. However, matrices also describe linear transformations, such as rotations and scaling operations, and define systems of linear equations.</p></li>
</ul>
<p>Finally, we consider a crucial application area, namely, the formulation and solution of systems of linear algebraic equations:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#content-references-soln-laes-start"><span class="std std-ref">Linear algebraic equations</span></a> arise in many different Engineering fields. In Chemical Engineering, these equations naturally arise from steady-state balance equations. We’ll introduce two approaches to solving these systems of equations.</p></li>
</ul>
<hr class="docutils" />
</section>
<section id="review-of-balances">
<span id="content-references-matrix-vector-mass-mol-balances"></span><h2>Review of balances<a class="headerlink" href="#review-of-balances" title="Permalink to this headline">#</a></h2>
<p>Streams of <em>stuff</em> (e.g., material, energy, money, information, etc.) enter (exit) a system from the surroundings; streams cross the system boundary, transporting <em>stuff</em> into or from the system. A system is said to be <em>open</em>  if <em>material stuff</em> can enter or exit the system; otherwise, a system is <em>closed</em>. For physical systems, streams can be pipes in which material flows into or from the system at some rate. In other cases, streams into (from) a system can carry other types of <em>stuff</em> such as information (e.g., bits) or money (e.g., <span class="math notranslate nohighlight">\(\$\)</span>, <span class="math notranslate nohighlight">\(\def\euro{\unicode{x20AC}} \euro\)</span>, bitcoin, etc).</p>
<p>Regardless if a system is open or closed and whatever <em>stuff</em> is, within the system,
<em>stuff</em> can accumulate and be generated, e.g., via a chemical reaction or by an interest process such as a savings account or treasury bond in the case of money. Whatever the system is, and whatever <em>stuff</em> is, the time behavior of the system can always be described by these <em>four</em> types of terms: inputs, outputs, generation, and accumulation.</p>
<section id="open-species-mass-balances">
<h3>Open species mass balances<a class="headerlink" href="#open-species-mass-balances" title="Permalink to this headline">#</a></h3>
<p>If we are interested in the mass of each chemical species, we can let <em>stuff</em> equal the mass of each of the chemical components; this choice gives the <em>open species mass balance</em> (<a class="reference internal" href="#defn-open-species-mass-balance">Definition 7</a>):</p>
<div class="proof definition admonition" id="defn-open-species-mass-balance">
<p class="admonition-title"><span class="caption-number">Definition 7 </span> (Open Species Mass Balance)</p>
<section class="definition-content" id="proof-content">
<p>Let <span class="math notranslate nohighlight">\(m_{i}\)</span> denote the mass of chemical component <span class="math notranslate nohighlight">\(i\)</span> in a system consisting of the species set <span class="math notranslate nohighlight">\(\mathcal{M}\)</span> (units: mass, e.g., grams g). Further, represent the set of streams flowing into (or from) the system as <span class="math notranslate nohighlight">\(\mathcal{S}\)</span>. Each stream <span class="math notranslate nohighlight">\(s\in\mathcal{S}\)</span> has a direction parameter <span class="math notranslate nohighlight">\(\nu_{s}\in\left[-1,1\right]\)</span>: If stream <span class="math notranslate nohighlight">\(s\)</span> <em>enters</em> the system <span class="math notranslate nohighlight">\(\nu_{s} = +1\)</span>, however, if stream <span class="math notranslate nohighlight">\(s\)</span> <em>exits</em> the system then <span class="math notranslate nohighlight">\(\nu_{s} = -1\)</span>.</p>
<p>Then, the mass of chemical component <span class="math notranslate nohighlight">\(i\)</span> in the system as a function of time (units: g) is described by an <em>open species mass balance equation</em>:</p>
<div class="math notranslate nohighlight" id="equation-eqn-species-mass-i-dynamic">
<span class="eqno">(14)<a class="headerlink" href="#equation-eqn-species-mass-i-dynamic" title="Permalink to this equation">#</a></span>\[\sum_{s\in\mathcal{S}}\nu_{s}\dot{m}_{i,s} + \dot{m}_{G,i} = \frac{dm_{i}}{dt}
\qquad\forall{i}\in\mathcal{M}\]</div>
<p>The quantity <span class="math notranslate nohighlight">\(\dot{m}_{i,s}\)</span> denotes the mass flow rate of component <span class="math notranslate nohighlight">\(i\)</span> in stream <span class="math notranslate nohighlight">\(s\)</span> (units: g <span class="math notranslate nohighlight">\(i\)</span>/time),
<span class="math notranslate nohighlight">\(\dot{m}_{G,i}\)</span> denote the rate of generation of component <span class="math notranslate nohighlight">\(i\)</span> in the system
(units: g <span class="math notranslate nohighlight">\(i\)</span>/time), and <span class="math notranslate nohighlight">\(dm_{i}/dt\)</span> denotes the rate of accumlation of mass of component <span class="math notranslate nohighlight">\(i\)</span> in the system (units: mass of <span class="math notranslate nohighlight">\(i\)</span> per time).</p>
<p><strong>Law of mass conservation</strong>:  The <a class="reference external" href="https://en.wikipedia.org/wiki/Conservation_of_mass">Law of Conservation of Mass</a> says that mass can neither be created nor destroyed, just rearranged or transformed. Thus, if we consume species <span class="math notranslate nohighlight">\(j\)</span>, the amount of mass-consumed must show up in the other species, i.e., the sum of the individual species mass generation terms must be zero:</p>
<div class="math notranslate nohighlight">
\[\sum_{i\in\mathcal{M}}\dot{m}_{G,i} = 0\]</div>
<p><strong>Steady state</strong>: At steady state, the accumulation term vanishes; thus, the steady state species mass balances are given by:</p>
<div class="math notranslate nohighlight" id="equation-eqn-species-mass-i-steady-state">
<span class="eqno">(15)<a class="headerlink" href="#equation-eqn-species-mass-i-steady-state" title="Permalink to this equation">#</a></span>\[\sum_{s\in\mathcal{S}}\nu_{s}\dot{m}_{i,s} + \dot{m}_{G,i} = 0
\qquad\forall{i}\in\mathcal{M}\]</div>
</section>
</div></section>
<section id="open-species-mole-balances">
<h3>Open species mole balances<a class="headerlink" href="#open-species-mole-balances" title="Permalink to this headline">#</a></h3>
<p>The principles of mole-based balance equations are similar to their mass-based equivalents, i.e., we can write species mole balances or total mole balances, and the terms play an equivalent role as their mass-based equivalents. However, mass-based units are generally convenient for systems that do not involve chemical reactions, and it is often easier to use mole-based units when chemical reactions occur.</p>
<p>Before we define the open species mole balance, let’s discuss the generation terms that appear in mole balances. Generation terms describe the impact of chemical reactions. For mole based systems we’ll use the <a class="reference external" href="https://en.wikipedia.org/wiki/Extent_of_reaction">open extent of reaction</a> to describe how far a chemical reaction has proceeded toward completion in an open system (<a class="reference internal" href="#defn-open-extent-of-rxn">Definition 8</a>):</p>
<div class="proof definition admonition" id="defn-open-extent-of-rxn">
<p class="admonition-title"><span class="caption-number">Definition 8 </span> (Open Extent of Reaction)</p>
<section class="definition-content" id="proof-content">
<p>Let chemical species set <span class="math notranslate nohighlight">\(\mathcal{M}\)</span> participate in the chemical reaction set <span class="math notranslate nohighlight">\(\mathcal{R}\)</span>. Then, the species generation rate <span class="math notranslate nohighlight">\(\dot{n}_{G, i}\)</span> (units: mol per time) can be written in terms of the open extent of reaction <span class="math notranslate nohighlight">\(\dot{\epsilon}_{r}\)</span> (units: mol per time):</p>
<div class="math notranslate nohighlight" id="equation-eqn-open-extent-species">
<span class="eqno">(16)<a class="headerlink" href="#equation-eqn-open-extent-species" title="Permalink to this equation">#</a></span>\[\dot{n}_{G,i} = \sum_{r\in\mathcal{R}}\sigma_{ir}\dot{\epsilon}_{r}\]</div>
<p>where <span class="math notranslate nohighlight">\(\dot{\epsilon}_{r}\)</span> denotes the open extent of reaction <span class="math notranslate nohighlight">\(r\)</span>. The quantity <span class="math notranslate nohighlight">\(\sigma_{ir}\)</span> denotes the stoichiometric coefficient for species <span class="math notranslate nohighlight">\(i\)</span> in reaction <span class="math notranslate nohighlight">\(r\)</span>:</p>
<ul class="simple">
<li><p>If <span class="math notranslate nohighlight">\(\sigma_{ir}&gt;0\)</span> then species <span class="math notranslate nohighlight">\(i\)</span> is <em>produced</em> by reaction <span class="math notranslate nohighlight">\(r\)</span>, i.e., species <span class="math notranslate nohighlight">\(i\)</span> is a product of reaction <span class="math notranslate nohighlight">\(r\)</span></p></li>
<li><p>If <span class="math notranslate nohighlight">\(\sigma_{ir}=0\)</span> then species <span class="math notranslate nohighlight">\(i\)</span> is <em>not connected to</em> reaction <span class="math notranslate nohighlight">\(r\)</span></p></li>
<li><p>If <span class="math notranslate nohighlight">\(\sigma_{ir}&lt;0\)</span> then species <span class="math notranslate nohighlight">\(i\)</span> is <em>consumed</em> by reaction <span class="math notranslate nohighlight">\(r\)</span>, i.e., species <span class="math notranslate nohighlight">\(i\)</span> is a reactant of reaction <span class="math notranslate nohighlight">\(r\)</span>.</p></li>
</ul>
<p><strong>Connection with kinetic rate</strong>: In a concentration-based system, we often use concentration balances, and the kinetic rate laws, to describe the system. The open extent of reaction <span class="math notranslate nohighlight">\(r\)</span> is related to kinetic rate law per unit volume <span class="math notranslate nohighlight">\(\hat{r}_{r}\)</span> (units: mol V<span class="math notranslate nohighlight">\(^{-1}\)</span> t<span class="math notranslate nohighlight">\(^{-1}\)</span>):</p>
<div class="math notranslate nohighlight" id="equation-eqn-open-extent-kinetics">
<span class="eqno">(17)<a class="headerlink" href="#equation-eqn-open-extent-kinetics" title="Permalink to this equation">#</a></span>\[\dot{\epsilon}_{r} = \hat{r}_{r}V\]</div>
<p>where <span class="math notranslate nohighlight">\(V\)</span> denotes the system volume (units: V).</p>
</section>
</div><p>Now that we understand how to describe the reaction terms, we can write the <em>open species mole balance</em>
(<a class="reference internal" href="#defn-open-species-mole-balance">Definition 9</a>):</p>
<div class="proof definition admonition" id="defn-open-species-mole-balance">
<p class="admonition-title"><span class="caption-number">Definition 9 </span> (Open Species Mole Balance)</p>
<section class="definition-content" id="proof-content">
<p>Let <span class="math notranslate nohighlight">\(n_{i}\in\mathcal{M}\)</span> denote the number of moles of chemical species <span class="math notranslate nohighlight">\(i\)</span> in a well-mixed system with species set <span class="math notranslate nohighlight">\(\mathcal{M}\)</span> which participates in the chemical reaction set <span class="math notranslate nohighlight">\(\mathcal{R}\)</span>. Further, let <span class="math notranslate nohighlight">\(\mathcal{S}\)</span> denote the streams flowing into (or from) the system. Each stream <span class="math notranslate nohighlight">\(s\in\mathcal{S}\)</span> has a direction parameter <span class="math notranslate nohighlight">\(\nu_{s}\in\left[-1,1\right]\)</span>: If stream <span class="math notranslate nohighlight">\(s\)</span> <em>enters</em> the system <span class="math notranslate nohighlight">\(\nu_{s} = +1\)</span>, however, is stream <span class="math notranslate nohighlight">\(s\)</span> <em>exits</em> the system then <span class="math notranslate nohighlight">\(\nu_{s} = -1\)</span>.</p>
<p>Then, the time evolution of <span class="math notranslate nohighlight">\(n_{i}\in\mathcal{M}\)</span> is described by an <em>open species mole balance equation</em> of the form:</p>
<div class="math notranslate nohighlight" id="equation-eqn-species-mol-balance">
<span class="eqno">(18)<a class="headerlink" href="#equation-eqn-species-mol-balance" title="Permalink to this equation">#</a></span>\[\sum_{s\in\mathcal{S}}\nu_{s}\dot{n}_{i,s} + \sum_{r\in\mathcal{R}}\sigma_{ir}\dot{\epsilon}_{r} = \frac{dn_{i}}{dt}
\qquad\forall{i}\in\mathcal{M}\]</div>
<p>The quantity <span class="math notranslate nohighlight">\(\dot{n}_{i,s}\)</span> denotes the mole flow rate of component <span class="math notranslate nohighlight">\(i\)</span> in stream <span class="math notranslate nohighlight">\(s\)</span> (units: mol per time), the generation terms are written using the open extent (units: mol per time), and <span class="math notranslate nohighlight">\(dn_{i}/dt\)</span> denotes the rate of accumulation of the number of moles of component <span class="math notranslate nohighlight">\(i\)</span> in the system (units: mol per time).</p>
<p><strong>Steady-state</strong>: At steady state, all the accumulation terms vanish and the system of balances becomes:</p>
<div class="math notranslate nohighlight" id="equation-eqn-species-mol-balance-ss">
<span class="eqno">(19)<a class="headerlink" href="#equation-eqn-species-mol-balance-ss" title="Permalink to this equation">#</a></span>\[\sum_{s\in\mathcal{S}}\nu_{s}\dot{n}_{i,s} + \sum_{r\in\mathcal{R}}\sigma_{ir}\dot{\epsilon}_{r} = 0
\qquad\forall{i}\in\mathcal{M}\]</div>
</section>
</div></section>
<section id="motivation-matrix-vector-notation-mole-balances">
<h3>Motivation: Matrix-vector notation mole balances<a class="headerlink" href="#motivation-matrix-vector-notation-mole-balances" title="Permalink to this headline">#</a></h3>
<p>To motivate the study of matrices and vectors, let’s rethink the open species mole balances given in
<a class="reference internal" href="#defn-open-species-mole-balance">Definition 9</a> in terms of a system of equations. Toward this, consider a simple reaction <span class="math notranslate nohighlight">\(A\longrightarrow{B}\)</span> occurring in a well-mixed chemical reactor with single input and a single output (<a class="reference internal" href="#fig-chemical-reactor-schematic"><span class="std std-numref">Fig. 11</span></a>):</p>
<figure class="align-default" id="fig-chemical-reactor-schematic">
<a class="reference internal image-reference" href="../_images/Fig-Reactor-Schematic.pdf"><img alt="../_images/Fig-Reactor-Schematic.pdf" src="../_images/Fig-Reactor-Schematic.pdf" style="height: 240px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 11 </span><span class="caption-text">Schematic of an open well-mixed chemical reactor with a single input and output stream.</span><a class="headerlink" href="#fig-chemical-reactor-schematic" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The species set in this case is <span class="math notranslate nohighlight">\(\mathcal{M}=\left\{A,B\right\}\)</span> and the stream set <span class="math notranslate nohighlight">\(\mathcal{S}=\left\{s_{1},s_{2}\right\}\)</span>, and there is a single chemical reaction; let <span class="math notranslate nohighlight">\(A\)</span> be species <code class="docutils literal notranslate"><span class="pre">1</span></code> and <span class="math notranslate nohighlight">\(B\)</span> be species <code class="docutils literal notranslate"><span class="pre">2</span></code>. <a class="reference internal" href="#defn-open-species-mole-balance">Definition 9</a> tells us that we’ll have a system of equations of the form (at steady-state):</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\dot{n}_{A,1} - \dot{n}_{A,2} - \dot{\epsilon}_{1} &amp; = &amp; 0 \\
\dot{n}_{B,1} - \dot{n}_{B,2} + \dot{\epsilon}_{1} &amp; = &amp; 0 \\
\end{eqnarray}
\end{split}\]</div>
<p>However, this system can be re-written in a much more compact (and general) form:</p>
<div class="math notranslate nohighlight" id="equation-eqn-matrix-vector-system-mol-bal">
<span class="eqno">(20)<a class="headerlink" href="#equation-eqn-matrix-vector-system-mol-bal" title="Permalink to this equation">#</a></span>\[\mathbf{T}\dot{\mathbf{n}} + \mathbf{S}\dot{\mathbf{\epsilon}} = \mathbf{0}\]</div>
<p>The <code class="docutils literal notranslate"><span class="pre">boldface</span></code> capital letters denote matrices, while small letters denote vectors. In this particular case, <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> denotes the transport matrix:</p>
<div class="math notranslate nohighlight" id="equation-eqn-t-matrix-example">
<span class="eqno">(21)<a class="headerlink" href="#equation-eqn-t-matrix-example" title="Permalink to this equation">#</a></span>\[\begin{split}\mathbf{T} = \begin{bmatrix}
1 &amp; -1 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 1 &amp; -1 \\
\end{bmatrix}\end{split}\]</div>
<p>and <span class="math notranslate nohighlight">\(\mathbf{S}\)</span> denotes the stoichiometric matrix:</p>
<div class="math notranslate nohighlight" id="equation-eqn-s-matrix-example">
<span class="eqno">(22)<a class="headerlink" href="#equation-eqn-s-matrix-example" title="Permalink to this equation">#</a></span>\[\begin{split}\mathbf{S} = \begin{bmatrix}
-1 \\
1 \\
\end{bmatrix}\end{split}\]</div>
<p>while <span class="math notranslate nohighlight">\(\dot{\mathbf{n}} = \left(\dot{n}_{A,1}, \dot{n}_{A,2}, \dot{n}_{B,1}, \dot{n}_{B,2}\right)^{T}\)</span> and
<span class="math notranslate nohighlight">\(\dot{\mathbf{\epsilon}} = \dot{\epsilon}_{1}\)</span>. The superscript <span class="math notranslate nohighlight">\(\star^{T}\)</span> denotes the transpose operation (turns a row into a column, or vice-versa). As it turns out, Eqn. <a class="reference internal" href="#equation-eqn-matrix-vector-system-mol-bal">(20)</a> is a particular instance of a general system
(<a class="reference internal" href="#defn-reaction-system-matrix-vector">Definition 10</a>):</p>
<div class="proof definition admonition" id="defn-reaction-system-matrix-vector">
<p class="admonition-title"><span class="caption-number">Definition 10 </span> (General open species mole balances)</p>
<section class="definition-content" id="proof-content">
<p>The steady-state species mole balances for any well-mixed reacting system with a species set <span class="math notranslate nohighlight">\(\mathcal{M}\)</span>, a reaction set <span class="math notranslate nohighlight">\(\mathcal{R}\)</span>, and stream set <span class="math notranslate nohighlight">\(\mathcal{S}\)</span> can be modeled by the matrix-vector system:</p>
<div class="math notranslate nohighlight">
\[\mathbf{T}\dot{\mathbf{n}} + \mathbf{S}\dot{\mathbf{\epsilon}} = \mathbf{0}\]</div>
<p>The matrix <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> is the <span class="math notranslate nohighlight">\(|\mathcal{M}| \times |\mathcal{M}||\mathcal{S}|\)</span> <em>transport matrix</em>, the matrix <span class="math notranslate nohighlight">\(\mathbf{S}\)</span> is the <span class="math notranslate nohighlight">\(|\mathcal{M}| \times |\mathcal{R}|\)</span> <em>stoichiometric matrix</em>, <span class="math notranslate nohighlight">\(\dot{\mathbf{n}}\)</span> denotes the <span class="math notranslate nohighlight">\(|\mathcal{M}||\mathcal{S}| \times {1}\)</span> species flow vector and <span class="math notranslate nohighlight">\(\mathbf{\epsilon}\)</span> denotes the <span class="math notranslate nohighlight">\(|\mathcal{R}| \times {1}\)</span> reaction vector.</p>
<p>The notation <span class="math notranslate nohighlight">\(|\star|\)</span> denotes the dimension (number of elements) of set <span class="math notranslate nohighlight">\(\star\)</span>.</p>
</section>
</div><!-- Matrices and vectors are encoded in computer programs as {ref}`content:references:lda-arrays` -->
<p>Matrices and vectors naturally arise in even simple chemical engineering systems like the one shown in <a class="reference internal" href="#fig-chemical-reactor-schematic"><span class="std std-numref">Fig. 11</span></a>. Let’s dig deeper into their definition, structure, and operations.</p>
</section>
</section>
<section id="matricies-and-vectors">
<span id="content-references-matrix-vector"></span><h2>Matricies and Vectors<a class="headerlink" href="#matricies-and-vectors" title="Permalink to this headline">#</a></h2>
<p>Matrices are two- (or more) dimensional rectangular arrays of numbers, widgets, etc that consist of <span class="math notranslate nohighlight">\(m\)</span> rows and <span class="math notranslate nohighlight">\(n\)</span> columns:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{A} = 
\begin{pmatrix}
a_{1,1} &amp; a_{1,2} &amp; \cdots &amp; a_{1,n} \\
a_{2,1} &amp; a_{2,2} &amp; \cdots &amp; a_{2,n} \\
\vdots  &amp; \vdots  &amp; \ddots &amp; \vdots  \\
a_{m,1} &amp; a_{m,2} &amp; \cdots &amp; a_{m,n} 
\end{pmatrix}\end{split}\]</div>
<p>The quantity <span class="math notranslate nohighlight">\(a_{ij}\in\mathbf{A}\)</span> denotes an <em>element</em> of the matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>, where <span class="math notranslate nohighlight">\(a_{ij}\)</span> lives on the <span class="math notranslate nohighlight">\(i\)</span>th row and <span class="math notranslate nohighlight">\(j\)</span>th column of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>. By convention, the row index is always the first subscript, while the column index is always listed second. Matrices can have different shapes (<a class="reference internal" href="#obs-matrix-shape">Observation 1</a>):</p>
<div class="proof observation admonition" id="obs-matrix-shape">
<p class="admonition-title"><span class="caption-number">Observation 1 </span> (Matrix shape)</p>
<section class="observation-content" id="proof-content">
<p>Let the matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> be an <span class="math notranslate nohighlight">\(m\times{n}\)</span> array. Then, the matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is called:</p>
<ul class="simple">
<li><p><strong>Square</strong>: If <span class="math notranslate nohighlight">\(m=n\)</span>, the matrix is called a <em>square</em> matrix; square matrices have some unique properties (as we shall see later).</p></li>
<li><p><strong>Overdetermined</strong>: If <span class="math notranslate nohighlight">\(m&gt;n\)</span>, the matrix is called an <em>overdetermined</em> matrix; overdetermined matrices have more rows than columns.</p></li>
<li><p><strong>Underdetermined</strong>: If <span class="math notranslate nohighlight">\(m&lt;n\)</span>, the matrix is called an <em>underdetermined</em> matrix; underdetermined matrices have more columns than rows.</p></li>
</ul>
</section>
</div><p>Vectors are a specal type of matrix that is one-dimensional, where <em>elements</em> are arranged as either a single row or single column. For example, a <span class="math notranslate nohighlight">\(m\times{1}\)</span> <em>column</em> vector <span class="math notranslate nohighlight">\(\mathbf{a}\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{a} = 
\begin{pmatrix}
a_{1} \\
a_{2} \\
\vdots \\
a_{m}
\end{pmatrix}\end{split}\]</div>
<p>while a <span class="math notranslate nohighlight">\({1}\times{n}\)</span> dimensional <em>row</em> vector <span class="math notranslate nohighlight">\(\mathbf{a}\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[\mathbf{a} = 
\begin{pmatrix}
a_{1} &amp; a_{2} &amp; \cdots &amp; a_{n}
\end{pmatrix}\]</div>
<p>Just like numbers, vectors and matrices can participate in mathematical operations, such as addition, subtraction and multiplication, with some small differences. However, before we explore the mathematical operations of matrices and vectors, we’ll discuss a few special matricies.</p>
<div class="proof remark admonition" id="rem-real-values">
<p class="admonition-title"><span class="caption-number">Remark 2 </span> (Restriction to real numbers)</p>
<section class="remark-content" id="proof-content">
<p>While the matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> or vector <span class="math notranslate nohighlight">\(\mathbf{v}\)</span> can theoretically hold any objects, e.g., strings, dictionaries, or trees, etc., in this section, we’ll only consider numbers, and in particular real numbers. Thus, we’ll assume all matrices are <span class="math notranslate nohighlight">\(\mathbf{A}\in\mathbb{R}^{n\times{m}}\)</span> and vectors <span class="math notranslate nohighlight">\(\mathbf{v}\in\mathbb{R}^{n}\)</span>; no complex numbers will be considered.</p>
</section>
</div><section id="special-matrices-and-matrix-properties">
<h3>Special matrices and matrix properties<a class="headerlink" href="#special-matrices-and-matrix-properties" title="Permalink to this headline">#</a></h3>
<p>Special matrices have specific properties or characteristics that make them useful in certain mathematical operations or applications.
Some examples of special matrices include:</p>
<ul class="simple">
<li><p><strong>Diagonal and identity matrices</strong>: A diagonal matrix is a square matrix in which all entries outside the main diagonal are zero. The special diagonal matrix with <code class="docutils literal notranslate"><span class="pre">1</span></code> on the diagonal and <code class="docutils literal notranslate"><span class="pre">0</span></code> everywhere else is called the <a class="reference external" href="https://en.wikipedia.org/wiki/Identity_matrix">Identity matrix</a>, and is often denoted by the symbol <span class="math notranslate nohighlight">\(\mathbf{I}\)</span>.</p></li>
<li><p><strong>Triangular matrices</strong>: <a class="reference external" href="https://en.wikipedia.org/wiki/Triangular_matrix">Triangular matrices</a> are square arrays with zero entries below or above the main diagonal. A square matrix is called <em>lower triangular</em> if all the entries above the main diagonal are zero. Similarly, a square matrix is called <em>upper triangular</em> if all the entries below the main diagonal are zero.</p></li>
<li><p><strong>Orthogonal matrices</strong>: <a class="reference external" href="https://en.wikipedia.org/wiki/Orthogonal_matrix">Orthogonal matrices</a>  are square matrices whose rows and columns are mutually orthogonal and have unit lengths.</p></li>
</ul>
<section id="trace-determinant-lu-decomposition-and-rank">
<span id="content-determinant-trace"></span><h4>Trace, Determinant, LU decomposition and Rank<a class="headerlink" href="#trace-determinant-lu-decomposition-and-rank" title="Permalink to this headline">#</a></h4>
<section id="trace">
<h5>Trace<a class="headerlink" href="#trace" title="Permalink to this headline">#</a></h5>
<p>The trace of a square matrix is the sum of the diagonal elements (<a class="reference internal" href="#defn-trace-A">Definition 11</a>):</p>
<div class="proof definition admonition" id="defn-trace-A">
<p class="admonition-title"><span class="caption-number">Definition 11 </span> (Trace)</p>
<section class="definition-content" id="proof-content">
<p>The trace of a square matrix is defined as the sum of its diagonal elements. Consider an <span class="math notranslate nohighlight">\(n\times{n}\)</span> square matrix <span class="math notranslate nohighlight">\(\mathbf{A}\in\mathbb{R}^{n\times{n}}\)</span>, where <span class="math notranslate nohighlight">\(a_{ij}\)</span> denotes the element on row <span class="math notranslate nohighlight">\(i\)</span> and column <span class="math notranslate nohighlight">\(j\)</span> of the matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>. Then, the trace, denoted as <span class="math notranslate nohighlight">\(\text{tr}\left(\mathbf{A}\right)\)</span>, is given by:</p>
<div class="math notranslate nohighlight" id="equation-eqn-trace-a">
<span class="eqno">(23)<a class="headerlink" href="#equation-eqn-trace-a" title="Permalink to this equation">#</a></span>\[\text{tr}\left(\mathbf{A}\right) = \sum_{i=1}^{n}a_{ii}\]</div>
</section>
</div><p>In <a class="reference external" href="https://julialang.org">Julia</a>, the <a class="reference external" href="https://docs.julialang.org/en/v1/stdlib/LinearAlgebra/#LinearAlgebra.tr">trace function</a> is encoded in the <a class="reference external" href="https://docs.julialang.org/en/v1/stdlib/LinearAlgebra/">LinearAlgebra</a> package included with the <a class="reference external" href="https://julialang.org">Julia</a> distribution. However, the <a class="reference external" href="https://docs.julialang.org/en/v1/stdlib/LinearAlgebra/">LinearAlgebra</a> package is not loaded by default (you’ll need to issue the <code class="docutils literal notranslate"><span class="pre">using</span> <span class="pre">LinearAlgebra</span></code> command to access its functions):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># load the LinearAlgebra package</span>
<span class="k">using</span> <span class="n">LinearAlgebra</span>

<span class="c"># Define array</span>
<span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="p">;</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">];</span> <span class="c"># the semicolon forces a newline </span>

<span class="c"># compute the trace, store in the variable value</span>
<span class="n">value</span> <span class="o">=</span> <span class="n">tr</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>

<span class="c"># What is the tr(A)</span>
<span class="n">println</span><span class="p">(</span><span class="s">&quot;The trace of the matrix tr(A) = </span><span class="si">$</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="s">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The trace of the matrix tr(A) = 5
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.trace.html">NumPy also has a trace function</a> if your are doing linear algebra calculations in <a class="reference external" href="https://www.python.org">Python</a>.</p>
</section>
<section id="determinant">
<h5>Determinant<a class="headerlink" href="#determinant" title="Permalink to this headline">#</a></h5>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Determinant">determinant of a matrix</a> is a scalar value that can be computed from a square matrix (<a class="reference internal" href="#defn-det-A">Definition 12</a>):</p>
<div class="proof definition admonition" id="defn-det-A">
<p class="admonition-title"><span class="caption-number">Definition 12 </span> (Leibniz determinant formula)</p>
<section class="definition-content" id="proof-content">
<p>The Leibniz determinant formula involves summing the products of elements in a square matrix, each taken from a different row and column, with a sign factor that alternates between positive and negative.</p>
<p>Let <span class="math notranslate nohighlight">\(\mathbf{A}\in\mathbb{R}^{n\times{n}}\)</span> and <span class="math notranslate nohighlight">\(a_{ij}\in\mathbf{A}\)</span> be the entry of row <span class="math notranslate nohighlight">\(i\)</span> and column <span class="math notranslate nohighlight">\(j\)</span> of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>.
Then, the determinant <span class="math notranslate nohighlight">\(\det\left(\mathbf{A}\right)\)</span> is given by:</p>
<div class="math notranslate nohighlight" id="equation-eqn-det-a">
<span class="eqno">(24)<a class="headerlink" href="#equation-eqn-det-a" title="Permalink to this equation">#</a></span>\[\det\left(\mathbf{A}\right) = \sum_{\sigma\in{S_{n}}}\text{sign}\left(\sigma\right)\prod_{i=1}^{n}a_{i\sigma_{i}}\]</div>
<p>where <span class="math notranslate nohighlight">\(S_{n}\)</span> denotes the Symmtery group of dimension <span class="math notranslate nohighlight">\(n\)</span>, i.e., the set of all possible permutations of the set <span class="math notranslate nohighlight">\({1,2,\dots,n}\)</span>,
the quantity <span class="math notranslate nohighlight">\(\text{sign}\left(\sigma\right)\)</span> equals <code class="docutils literal notranslate"><span class="pre">+1</span></code> if the permutation can be obtained with an even number of exchanges; otherwise <code class="docutils literal notranslate"><span class="pre">-1</span></code>. Finally, <span class="math notranslate nohighlight">\(a_{i\sigma_{i}}\)</span> denotes the entry of the matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> on row <span class="math notranslate nohighlight">\(i\)</span>, and column <span class="math notranslate nohighlight">\(\sigma_{i}\)</span>.</p>
</section>
</div><p><a class="reference external" href="https://en.wikipedia.org/wiki/Determinant">Determinants</a> can be used to determine whether a system of linear equations has a solution, but they also have other applications. However, the Leibniz determinant shown in <a class="reference internal" href="#defn-det-A">Definition 12</a> can be computationally expensive for large matrices since the number of permutations grows factorially with the matrix size. However, it provides a theoretical basis for understanding the determinant and can be helpful for small matrices or conceptual purposes.</p>
<p>In <a class="reference external" href="https://julialang.org">Julia</a>, the <a class="reference external" href="https://docs.julialang.org/en/v1/stdlib/LinearAlgebra/#LinearAlgebra.det">determinant function</a> is encoded in the <a class="reference external" href="https://docs.julialang.org/en/v1/stdlib/LinearAlgebra/">LinearAlgebra</a> package included with the <a class="reference external" href="https://julialang.org">Julia</a> distribution. However, the <a class="reference external" href="https://docs.julialang.org/en/v1/stdlib/LinearAlgebra/">LinearAlgebra</a> package is not loaded by default (you’ll need to issue the <code class="docutils literal notranslate"><span class="pre">using</span> <span class="pre">LinearAlgebra</span></code> command to access its functions):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># load the LinearAlgebra package</span>
<span class="k">using</span> <span class="n">LinearAlgebra</span>

<span class="c"># Define array</span>
<span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="p">;</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">];</span> <span class="c"># the semicolon forces a newline </span>

<span class="c"># compute the determinant, store in the variable value</span>
<span class="n">value</span> <span class="o">=</span> <span class="n">det</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>

<span class="c"># What is the det(A)</span>
<span class="n">println</span><span class="p">(</span><span class="s">&quot;The determinant of the matrix det(A) = </span><span class="si">$</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="s">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The determinant of the matrix det(A) = -2.0
</pre></div>
</div>
</div>
</div>
<p>Although the determinant of a general square matrix is expensive to calculate, determinants of triangular matrices are easy to compute:</p>
<div class="proof observation admonition" id="obs-determinant-triangular-matrix">
<p class="admonition-title"><span class="caption-number">Observation 2 </span> (Determinant triangular matrix)</p>
<section class="observation-content" id="proof-content">
<p>The determinant of a triangular matrix is equal to the product of its diagonal elements. This is true for both upper triangular <span class="math notranslate nohighlight">\(\mathbf{U}\)</span> and lower <span class="math notranslate nohighlight">\(\mathbf{L}\)</span> triangular matrices. For example, the determinant of the upper triangular <span class="math notranslate nohighlight">\(n\times{n}\)</span> matrix <span class="math notranslate nohighlight">\(\mathbf{U}\)</span> is equal to:</p>
<div class="math notranslate nohighlight">
\[\det\left(\mathbf{U}\right) = \prod_{i=1}^{n}u_{ii}\]</div>
<p>A similar expression could be written for a lower triangular matrix <span class="math notranslate nohighlight">\(\mathbf{L}\)</span>.</p>
</section>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># load the LinearAlgebra package</span>
<span class="k">using</span> <span class="n">LinearAlgebra</span>

<span class="c"># Define array</span>
<span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">0</span> <span class="p">;</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">];</span> <span class="c"># the semicolon forces a newline </span>

<span class="c"># compute the determinant, store in the variable value</span>
<span class="n">value</span> <span class="o">=</span> <span class="n">det</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>

<span class="c"># What is the det(A)</span>
<span class="n">println</span><span class="p">(</span><span class="s">&quot;The determinant of the matrix det(A) = </span><span class="si">$</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="s">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The determinant of the matrix det(A) = 3.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="lu-decomposition">
<h5>LU decomposition<a class="headerlink" href="#lu-decomposition" title="Permalink to this headline">#</a></h5>
<p>LU decomposition, also known as LU factorization, is a method of decomposing a square matrix <span class="math notranslate nohighlight">\(\mathbf{A}\in\mathbb{R}^{n\times{n}}\)</span> into the product of a permutation matrix <span class="math notranslate nohighlight">\(\mathbf{P}\)</span>, and lower and upper triangular matrices <span class="math notranslate nohighlight">\(\mathbf{L}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{U}\)</span>, respectively, such that <span class="math notranslate nohighlight">\(\mathbf{A} = \mathbf{P}\mathbf{L}\mathbf{U}\)</span>.</p>
<p>LU decomposition is a widely used numerical linear algebra technique with many applications. For example, the LU decomposition simplifies the computation of determinants (<a class="reference internal" href="#defn-LU-determinant">Definition 13</a>):</p>
<div class="proof definition admonition" id="defn-LU-determinant">
<p class="admonition-title"><span class="caption-number">Definition 13 </span> (LU decomposition)</p>
<section class="definition-content" id="proof-content">
<p>Let the <span class="math notranslate nohighlight">\(\mathbf{A}\in\mathbb{R}^{n\times{n}}\)</span> be LU factoriable, such that <span class="math notranslate nohighlight">\(\mathbf{A} = \mathbf{P}\mathbf{L}\mathbf{U}\)</span>. Then, the determinant <span class="math notranslate nohighlight">\(\det\left(\mathbf{A}\right)\)</span> is given by:</p>
<div class="math notranslate nohighlight" id="equation-eqn-lu-det">
<span class="eqno">(25)<a class="headerlink" href="#equation-eqn-lu-det" title="Permalink to this equation">#</a></span>\[\det\left(\mathbf{A}\right) = \det\left(\mathbf{P}\right)\cdot\det\left(\mathbf{L}\right)\cdot\det\left(\mathbf{U}\right)\]</div>
</section>
</div><p>In <a class="reference external" href="https://julialang.org">Julia</a>, the <a class="reference external" href="https://docs.julialang.org/en/v1/stdlib/LinearAlgebra/#LinearAlgebra.lu">LU factorization</a> is encoded in the <a class="reference external" href="https://docs.julialang.org/en/v1/stdlib/LinearAlgebra/">LinearAlgebra</a> package included with the <a class="reference external" href="https://julialang.org">Julia</a> standard library:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># load the LinearAlgebra package</span>
<span class="k">using</span> <span class="n">LinearAlgebra</span>

<span class="c"># Define array</span>
<span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="p">;</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">];</span> <span class="c"># the semicolon forces a newline </span>

<span class="c"># compute the determinant, store in the variable value</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">lu</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">L</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">U</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">P</span>

<span class="c"># Test -</span>
<span class="n">AT</span> <span class="o">=</span> <span class="n">P</span><span class="o">*</span><span class="n">L</span><span class="o">*</span><span class="n">U</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2×2 Matrix{Float64}:
 1.0  2.0
 3.0  4.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="rank">
<h5>Rank<a class="headerlink" href="#rank" title="Permalink to this headline">#</a></h5>
<p>Finally, the <a class="reference external" href="https://en.wikipedia.org/wiki/Rank_(linear_algebra)">rank of a matrix</a> is a measure of the number of linearly independent rows or columns (<a class="reference internal" href="#defn-rank-A">Definition 14</a>):</p>
<div class="proof definition admonition" id="defn-rank-A">
<p class="admonition-title"><span class="caption-number">Definition 14 </span> (Rank)</p>
<section class="definition-content" id="proof-content">
<p>The rank of a matrix <em>r</em> of a <span class="math notranslate nohighlight">\(m\times{n}\)</span> matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is always less than or equal to the minimum of its number of rows and columns:</p>
<div class="math notranslate nohighlight" id="equation-eqn-rank-inequality">
<span class="eqno">(26)<a class="headerlink" href="#equation-eqn-rank-inequality" title="Permalink to this equation">#</a></span>\[r\leq\min\left(m,n\right)\]</div>
<p>Rank can also be considered a measure of the unique information in a matrix; if there is redundant information (rows or columns that are not linearly independent), a matrix will have less than full rank.</p>
</section>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># load the LinearAlgebra package</span>
<span class="k">using</span> <span class="n">LinearAlgebra</span>

<span class="c"># Define array</span>
<span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="p">;</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">];</span> <span class="c"># the semicolon forces a newline </span>

<span class="c"># compute the rank, store in the variable value</span>
<span class="n">value</span> <span class="o">=</span> <span class="n">rank</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>

<span class="c"># What is the rank(A)</span>
<span class="n">println</span><span class="p">(</span><span class="s">&quot;The rank of the matrix rank(A) = </span><span class="si">$</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="s">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The rank of the matrix rank(A) = 2
</pre></div>
</div>
</div>
</div>
<!-- The kernel of a matrix is the set of all solutions to the homogeneous equation $\mathbf{A}\mathbf{x} = \mathbf{0}$, where $\mathbf{A}$ is the matrix, and $\mathbf{x}$ is a column vector. The dimension of the kernel is equal to the number of columns in the matrix minus its rank. The kernel is also known as the null space of the matrix. -->
</section>
</section>
</section>
</section>
<section id="mathematical-matrix-and-vector-operations">
<span id="content-matrix-vector-operations"></span><h2>Mathematical matrix and vector operations<a class="headerlink" href="#mathematical-matrix-and-vector-operations" title="Permalink to this headline">#</a></h2>
<p>Matrix and vector operations are mathematical procedures to add, subtract and multiple matrices and vectors.  Matrix and vector operations are similar in some wats to scalar numbers, with some crucial differences and one important caveat: <em>they must be compatible</em>.</p>
<p>Many (if not all) modern programming languages implement a version of the <a class="reference external" href="https://en.wikipedia.org/wiki/Basic_Linear_Algebra_Subprograms">Basic Linear Algebra Subprograms (BLAS)</a> library. <a class="reference external" href="https://en.wikipedia.org/wiki/Basic_Linear_Algebra_Subprograms">BLAS</a> is a low-level library that efficiently implements basic linear algebra operations, such as vector and matrix multiplication, matrix-vector multiplication, and solving linear systems of equations. The library is designed to provide high-performance implementations of these routines that can be used as building blocks for more complex algorithms.</p>
<p>However, while you will not have to implement most matrix and vector operations on your own, it is still helpful to understand these operations and how broadly they work.</p>
<section id="addition-and-subtraction">
<h3>Addition and subtraction<a class="headerlink" href="#addition-and-subtraction" title="Permalink to this headline">#</a></h3>
<p>Compatible matrices and vectors can be added and subtracted just like scalar quantities. The addition (or subtraction) operations for matrices or vectors are done element-wise. Thus, if these objects don’t have the same number of elements, then addition and subtraction operations don’t make sense.</p>
<div class="proof definition admonition" id="obs-same-dimension">
<p class="admonition-title"><span class="caption-number">Definition 15 </span> (Vector addition)</p>
<section class="definition-content" id="proof-content">
<p>Suppose we have two vectors <span class="math notranslate nohighlight">\(\mathbf{a}\in\mathbb{R}^{m}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{b}\in\mathbb{R}^{m}\)</span>. The sum of these vectors <span class="math notranslate nohighlight">\(\mathbf{y} = \mathbf{a} + \mathbf{b}\)</span> is the vector <span class="math notranslate nohighlight">\(\mathbf{y}\in\mathbb{R}^{m}\)</span> given by:</p>
<div class="math notranslate nohighlight" id="equation-eqn-vector-addition">
<span class="eqno">(27)<a class="headerlink" href="#equation-eqn-vector-addition" title="Permalink to this equation">#</a></span>\[y_{i} = a_{i} + b_{i}\qquad{i=1,\dots,m}\]</div>
<p><strong>Compatibility</strong>: The vectors <span class="math notranslate nohighlight">\(\mathbf{a}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> are compatible if they have the same number of elements.</p>
</section>
</div><p>Vector addition is straightforward to implement (<a class="reference internal" href="#algo-vector-addition">Algorithm 4</a>):</p>
<div class="proof algorithm dropdown admonition" id="algo-vector-addition">
<p class="admonition-title"><span class="caption-number">Algorithm 4 </span> (Naive vector addition)</p>
<section class="algorithm-content" id="proof-content">
<p><strong>Inputs</strong> Compatible vectors <span class="math notranslate nohighlight">\(\mathbf{a}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{b}\)</span></p>
<p><strong>Outputs</strong> Vector sum <span class="math notranslate nohighlight">\(\mathbf{y}\)</span></p>
<p><strong>Initialize</strong></p>
<ol class="simple">
<li><p>set <span class="math notranslate nohighlight">\(n\leftarrow\text{length}(\mathbf{a})\)</span></p></li>
<li><p>set <span class="math notranslate nohighlight">\(\mathbf{y}\leftarrow\text{zeros}(n)\)</span></p></li>
</ol>
<p><strong>Main</strong></p>
<ol class="simple">
<li><p>for <span class="math notranslate nohighlight">\(i\in{1,\dots,n}\)</span></p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(y_{i}\leftarrow~a_{i} + b_{i}\)</span></p></li>
</ol>
</li>
</ol>
<p><strong>Return</strong> sum vector <span class="math notranslate nohighlight">\(\mathbf{y}\)</span></p>
</section>
</div><section id="is-the-naive-approach-really-the-best">
<h4>Is the naive approach really the best?<a class="headerlink" href="#is-the-naive-approach-really-the-best" title="Permalink to this headline">#</a></h4>
<p><a class="reference internal" href="#algo-vector-addition">Algorithm 4</a> may not be the <em>best</em> way to implement vector (or matrix) addition or subtraction operations. Many modern programming languages and libraries, e.g., <a class="reference external" href="https://numpy.org">the Numpy library in Python</a> or <a class="reference external" href="https://julialang.org">Julia</a>, support <em>vectorization</em>, i.e., special operators that encode element-wise addition, subtraction or other types of element-wise operations without the need to write <code class="docutils literal notranslate"><span class="pre">for</span></code> loops.</p>
<p>In <a class="reference external" href="https://julialang.org">Julia</a>, you can use the vectorized <code class="docutils literal notranslate"><span class="pre">.+</span></code> operator for element-wise addition, while element-wise subtraction can be encoded with the <code class="docutils literal notranslate"><span class="pre">.-</span></code> operator. Vectorized code typically executes faster than naive implementations such as <a class="reference internal" href="#algo-vector-addition">Algorithm 4</a> because the <em>vectorization</em> takes advantage of advanced techniques to improve performance.</p>
<section id="additional-information-on-vectorization">
<h5>Additional information on vectorization<a class="headerlink" href="#additional-information-on-vectorization" title="Permalink to this headline">#</a></h5>
<ul class="simple">
<li><p><a class="reference external" href="https://www.geeksforgeeks.org/vectorized-operations-in-numpy/">Vectorized operations in NumPy</a>. <a class="reference external" href="https://numpy.org">NumPy</a> is a Python scientific computing package. It is a Python library that provides multidimensional array objects and routines for fast operations on arrays.</p></li>
<li><p><a class="reference external" href="https://docs.julialang.org/en/v1/manual/functions/#man-vectorized">Vectorized operations in Julia</a> are included in the standard library. The standard library already defines common operators such as addition <code class="docutils literal notranslate"><span class="pre">.+</span></code>, subtraction <code class="docutils literal notranslate"><span class="pre">.-</span></code>, multiplication <code class="docutils literal notranslate"><span class="pre">.*</span></code>, and power <code class="docutils literal notranslate"><span class="pre">.^</span></code>. However, the <a class="reference external" href="https://docs.julialang.org/en/v1/manual/arrays/#Broadcasting">broadcasting</a> paradigm allows you to write your own vectorized operations.</p></li>
</ul>
</section>
</section>
</section>
<section id="multiplication-operations">
<h3>Multiplication operations<a class="headerlink" href="#multiplication-operations" title="Permalink to this headline">#</a></h3>
<section id="scalar-multiplication">
<h4>Scalar multiplication<a class="headerlink" href="#scalar-multiplication" title="Permalink to this headline">#</a></h4>
<p>The most straightforward multiplication operation is between a scalar and a vector (or matrix). Multiplying a vector (or a matrix) by a scalar constant is done element-wise (<a class="reference internal" href="#defn-scalar-multiplication">Definition 16</a>):</p>
<div class="proof definition admonition" id="defn-scalar-multiplication">
<p class="admonition-title"><span class="caption-number">Definition 16 </span> (Scalar multiplication of a matrix or vector)</p>
<section class="definition-content" id="proof-content">
<p><strong>Vector</strong>: Suppose we have a vector <span class="math notranslate nohighlight">\(\mathbf{v}\in\mathbb{R}^{n}\)</span> and a real scalar constant <span class="math notranslate nohighlight">\(c\in\mathbb{R}\)</span>. Then the scalar product, denoted by <span class="math notranslate nohighlight">\(\mathbf{y} = c\mathbf{v}\)</span>, is given by:</p>
<div class="math notranslate nohighlight">
\[y_{i} = cv_{i}\qquad{i=1,2,\dots,n}\]</div>
<p>where <span class="math notranslate nohighlight">\(y_{i}\)</span> and <span class="math notranslate nohighlight">\(v_{i}\)</span> denote the ith component of the product vector <span class="math notranslate nohighlight">\(\mathbf{y}\in\mathbb{R}^{n}\)</span>, and the input vector <span class="math notranslate nohighlight">\(\mathbf{v}\in\mathbb{R}^{n}\)</span>.</p>
<p><strong>Matrix</strong>: Likewise, suppose we have the matrix <span class="math notranslate nohighlight">\(\mathbf{X}\in\mathbb{R}^{m\times{n}}\)</span> and a real scalar constant <span class="math notranslate nohighlight">\(c\in\mathbb{R}\)</span>. Then, the scalar product, denoted by <span class="math notranslate nohighlight">\(\mathbf{Y} = c\mathbf{X}\)</span>, is given by:</p>
<div class="math notranslate nohighlight">
\[y_{ij} = cx_{ij}\qquad{i=1,2,\dots,m,~j=1,2,\dots,n}\]</div>
<p>where <span class="math notranslate nohighlight">\(y_{ij}\)</span> and <span class="math notranslate nohighlight">\(x_{ij}\)</span> denote components of the product matrix <span class="math notranslate nohighlight">\(\mathbf{Y}\in\mathbb{R}^{m\times{n}}\)</span>, and the input matrix <span class="math notranslate nohighlight">\(\mathbf{X}\in\mathbb{R}^{m\times{n}}\)</span>, respectively.</p>
</section>
</div></section>
<section id="vector-vector-operations">
<span id="content-vector-vector-operations"></span><h4>Vector-vector operations<a class="headerlink" href="#vector-vector-operations" title="Permalink to this headline">#</a></h4>
<p><strong>Inner product</strong>: Two compatible vectors <span class="math notranslate nohighlight">\(\mathbf{a}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> can be multiplied together to produce a <em>scalar</em> in an operation called an <a class="reference external" href="https://en.wikipedia.org/wiki/Inner_product_space">inner product operation</a> (<a class="reference internal" href="#defn-vector-vector-multiplication">Definition 17</a>):</p>
<div class="proof definition admonition" id="defn-vector-vector-multiplication">
<p class="admonition-title"><span class="caption-number">Definition 17 </span> (Inner product)</p>
<section class="definition-content" id="proof-content">
<p>Let <span class="math notranslate nohighlight">\(\mathbf{a}\in\mathbb{R}^{m\times{1}}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{b}\in\mathbb{R}^{m\times{1}}\)</span>. Then, the <em>vector-vector inner product</em> is given by:</p>
<div class="math notranslate nohighlight" id="equation-eqn-vector-vector-inner-product">
<span class="eqno">(28)<a class="headerlink" href="#equation-eqn-vector-vector-inner-product" title="Permalink to this equation">#</a></span>\[y = \mathbf{a}^{T}\mathbf{b}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{a}^{T}\)</span> denotes the transpose of the vector <span class="math notranslate nohighlight">\(\mathbf{a}\)</span> and the scalar <span class="math notranslate nohighlight">\(y\)</span> equals:</p>
<div class="math notranslate nohighlight" id="equation-eqn-vector-inner-product-index-form">
<span class="eqno">(29)<a class="headerlink" href="#equation-eqn-vector-inner-product-index-form" title="Permalink to this equation">#</a></span>\[y = \sum_{i=1}^{m}a_{i}b_{i}\]</div>
<p><strong>Compatibility</strong>: This operation is possible if the vectors <span class="math notranslate nohighlight">\(\mathbf{a}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> have the same number of elements.</p>
</section>
</div><p><strong>Outer product</strong>: Suppose you have an <span class="math notranslate nohighlight">\(m\times{1}\)</span> vector <span class="math notranslate nohighlight">\(\mathbf{a}\)</span>, and an <span class="math notranslate nohighlight">\(n\times{1}\)</span> vector <span class="math notranslate nohighlight">\(\mathbf{b}\)</span>. The vectors <span class="math notranslate nohighlight">\(\mathbf{a}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> can be multipled together to form a <span class="math notranslate nohighlight">\(m\times{n}\)</span> matrix through an <a class="reference external" href="https://en.wikipedia.org/wiki/Outer_product">outer product operation</a> (<a class="reference internal" href="#defn-vector-vector-multiplication-op">Definition 18</a>):</p>
<div class="proof definition admonition" id="defn-vector-vector-multiplication-op">
<p class="admonition-title"><span class="caption-number">Definition 18 </span> (Outer product)</p>
<section class="definition-content" id="proof-content">
<p>Let <span class="math notranslate nohighlight">\(\mathbf{a}\in\mathbb{R}^{m\times{1}}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{b}\in\mathbb{R}^{n\times{1}}\)</span>. Then, the <em>vector-vector outer product</em> given by:</p>
<div class="math notranslate nohighlight" id="equation-eqn-vector-vector-outer-product">
<span class="eqno">(30)<a class="headerlink" href="#equation-eqn-vector-vector-outer-product" title="Permalink to this equation">#</a></span>\[\mathbf{Y} = \mathbf{a}\otimes\mathbf{b}\]</div>
<p>produces the matrix <span class="math notranslate nohighlight">\(\mathbf{Y}\in\mathbb{R}^{m\times{n}}\)</span> with elements:</p>
<div class="math notranslate nohighlight" id="equation-eqn-vector-outer-product-index-form">
<span class="eqno">(31)<a class="headerlink" href="#equation-eqn-vector-outer-product-index-form" title="Permalink to this equation">#</a></span>\[y_{ij} = a_{i}b_{j}\qquad{i=1,2,\dots,m~\text{and}~j=1,2,\dots,n}\]</div>
<p>The outer product operation is equivalent to <span class="math notranslate nohighlight">\(\mathbf{Y} = \mathbf{a}\mathbf{b}^{T}\)</span>.</p>
<p><strong>Compatibility</strong>: This operation is possible if the vectors <span class="math notranslate nohighlight">\(\mathbf{a}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> have the same number of elements.</p>
</section>
</div></section>
<section id="right-multiplication-of-a-matrix-by-a-vector">
<h4>Right multiplication of a matrix by a vector<a class="headerlink" href="#right-multiplication-of-a-matrix-by-a-vector" title="Permalink to this headline">#</a></h4>
<p>A common operation is <em>right matrix-vector multiplication</em> of a matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> by a vector <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>. If the matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> and the vector <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> are compatible,  <em>right matrix-vector multiplication</em> will produce a vector with the same number of rows as the original matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> (<a class="reference internal" href="#defn-right-matrix-vector-multiplication">Definition 19</a>):</p>
<div class="proof definition admonition" id="defn-right-matrix-vector-multiplication">
<p class="admonition-title"><span class="caption-number">Definition 19 </span> (Right matrix-vector multiplication)</p>
<section class="definition-content" id="proof-content">
<p>Let <span class="math notranslate nohighlight">\(\mathbf{A}\in\mathbb{R}^{m\times{n}}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{x}\in\mathbb{R}^{n\times{1}}\)</span>. Then, the right matrix-vector product given by:</p>
<div class="math notranslate nohighlight">
\[\mathbf{y} = \mathbf{A}\mathbf{x}\]</div>
<p>generates the <span class="math notranslate nohighlight">\(\mathbf{y}\in\mathbb{R}^{m\times{1}}\)</span> vector where the <span class="math notranslate nohighlight">\(i\)</span>th element is given by:</p>
<div class="math notranslate nohighlight">
\[y_{i} = \sum_{j=1}^{n}a_{ij}x_{j}\qquad{i=1,2,\cdots,m}\]</div>
<p><strong>Compatibility</strong>: This operation is possible if the number of columns of the matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> equals the number of rows of the vector <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>.</p>
</section>
</div><p>The right multiplication operation can be represented graphically as a series of scalar<span class="math notranslate nohighlight">\(\times\)</span>vector multiplication and vector-vector summation operations (<a class="reference internal" href="#fig-right-multiplication-matrix-vector"><span class="std std-numref">Fig. 12</span></a>):</p>
<figure class="align-default" id="fig-right-multiplication-matrix-vector">
<a class="reference internal image-reference" href="../_images/Fig-Ab-Multiplication.pdf"><img alt="../_images/Fig-Ab-Multiplication.pdf" src="../_images/Fig-Ab-Multiplication.pdf" style="height: 140px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 12 </span><span class="caption-text">Schematic of the right matrix-vector product. The right product, which produces a column vector with the same number of rows as the matrix, can be modeled as a series of scalar<span class="math notranslate nohighlight">\(\times\)</span>vector multiplication and vector-vector summation operations.</span><a class="headerlink" href="#fig-right-multiplication-matrix-vector" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>A psuedo code implemetation of <a class="reference internal" href="#defn-right-matrix-vector-multiplication">Definition 19</a> is given in <a class="reference internal" href="#algo-right-multiplication-matrix-vector">Algorithm 5</a>:</p>
<div class="proof algorithm dropdown admonition" id="algo-right-multiplication-matrix-vector">
<p class="admonition-title"><span class="caption-number">Algorithm 5 </span> (Naive right multiplication of a matrix by a vector)</p>
<section class="algorithm-content" id="proof-content">
<p><strong>Inputs:</strong> Matrix <span class="math notranslate nohighlight">\(\mathbf{A}\in\mathbb{R}^{m\times{n}}\)</span> and vector <span class="math notranslate nohighlight">\(\mathbf{x}\in\mathbb{R}^{n\times{1}}\)</span></p>
<p><strong>Outputs:</strong> Product vector <span class="math notranslate nohighlight">\(\mathbf{y}\in\mathbb{R}^{m\times{1}}\)</span>.</p>
<p><strong>Initialize</strong></p>
<ol class="simple">
<li><p>set  <span class="math notranslate nohighlight">\((m, n)\leftarrow\text{size}(\mathbf{A})\)</span></p></li>
<li><p>initialize <span class="math notranslate nohighlight">\(\mathbf{y}\leftarrow\text{zeros}(m)\)</span></p></li>
</ol>
<p><strong>Main</strong></p>
<ol class="simple">
<li><p>for <span class="math notranslate nohighlight">\(i\in{1,\dots,m}\)</span>:</p>
<ol class="simple">
<li><p>for <span class="math notranslate nohighlight">\(j\in{1,\dots,n}\)</span>:</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(y_{i}~\leftarrow y_{i} + a_{ij}\times{x_{j}}\)</span></p></li>
</ol>
</li>
</ol>
</li>
</ol>
<p><strong>Return</strong> vector <span class="math notranslate nohighlight">\(\mathbf{y}\)</span></p>
</section>
</div></section>
<section id="left-multiplication-of-a-matrix-by-a-vector">
<h4>Left multiplication of a matrix by a vector<a class="headerlink" href="#left-multiplication-of-a-matrix-by-a-vector" title="Permalink to this headline">#</a></h4>
<p>We could also consider the <em>left multiplication</em> of a matrix by a vector. Suppose <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is an <span class="math notranslate nohighlight">\(m\times{n}\)</span> matrix, and <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> is a <span class="math notranslate nohighlight">\(m\times{1}\)</span> vector, then the <em>left matrix-vector product</em> is a row vector (<a class="reference internal" href="#defn-left-multiply-matrix-vector">Definition 20</a>):</p>
<div class="proof definition admonition" id="defn-left-multiply-matrix-vector">
<p class="admonition-title"><span class="caption-number">Definition 20 </span> (Left matrix-vector product)</p>
<section class="definition-content" id="proof-content">
<p>Let <span class="math notranslate nohighlight">\(\mathbf{A}\in\mathbb{R}^{m\times{n}}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{x}\in\mathbb{R}^{m\times{1}}\)</span>. Then, the <em>left matrix-vector product</em>:</p>
<div class="math notranslate nohighlight" id="equation-eqn-left-matrix-vector-product-matrix">
<span class="eqno">(32)<a class="headerlink" href="#equation-eqn-left-matrix-vector-product-matrix" title="Permalink to this equation">#</a></span>\[\mathbf{y} = \mathbf{x}^{T}\mathbf{A}\]</div>
<p>produces the vector <span class="math notranslate nohighlight">\(\mathbf{y}\in\mathbb{R}^{1\times{n}}\)</span> such that:</p>
<div class="math notranslate nohighlight" id="equation-eqn-left-matrix-vector-product-index">
<span class="eqno">(33)<a class="headerlink" href="#equation-eqn-left-matrix-vector-product-index" title="Permalink to this equation">#</a></span>\[y_{i} = \sum_{j=1}^{m}a_{ji}x_{j}\qquad{i=1,2,\dots,n}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{x}^{T}\)</span> denotes the <a class="reference external" href="https://en.wikipedia.org/wiki/Transpose">transpose</a> of the vector <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>.</p>
<p><strong>Compatibility</strong>: This operation is possible if the number of rows of the matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> equals the number of columns of the transpose of the vector <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>.</p>
</section>
</div><p>The <em>left multiplication operation</em> can be represented graphically as a series of scalar<span class="math notranslate nohighlight">\(\times\)</span>vector multiplication and vector-vector summation operations (<a class="reference internal" href="#fig-left-multiplication-matrix-vector"><span class="std std-numref">Fig. 13</span></a>):</p>
<figure class="align-default" id="fig-left-multiplication-matrix-vector">
<a class="reference internal image-reference" href="../_images/Fig-bA-Left-Multiplication.pdf"><img alt="../_images/Fig-bA-Left-Multiplication.pdf" src="../_images/Fig-bA-Left-Multiplication.pdf" style="height: 160px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 13 </span><span class="caption-text">Schematic of the left matrix-vector product. The left product, which produces a row vector with the same number of columns as the matrix, can be modeled as a series of scalar<span class="math notranslate nohighlight">\(\times\)</span>vector multiplication and vector-vector summation operations.</span><a class="headerlink" href="#fig-left-multiplication-matrix-vector" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>A psuedo code implemetation of <a class="reference internal" href="#defn-left-multiply-matrix-vector">Definition 20</a> is given in <a class="reference internal" href="#algo-left-multiplication-matrix-vector">Algorithm 6</a>:</p>
<div class="proof algorithm dropdown admonition" id="algo-left-multiplication-matrix-vector">
<p class="admonition-title"><span class="caption-number">Algorithm 6 </span> (Naive left multiplication of a matrix by a vector)</p>
<section class="algorithm-content" id="proof-content">
<p><strong>Inputs:</strong> Matrix <span class="math notranslate nohighlight">\(\mathbf{A}\in\mathbb{R}^{m\times{n}}\)</span> and vector <span class="math notranslate nohighlight">\(\mathbf{x}\in\mathbb{R}^{m\times{1}}\)</span></p>
<p><strong>Outputs:</strong> Product vector <span class="math notranslate nohighlight">\(\mathbf{y}\in\mathbb{R}^{1\times{n}}\)</span>.</p>
<p><strong>Initialize</strong></p>
<ol class="simple">
<li><p>set  <span class="math notranslate nohighlight">\((m, n)\leftarrow\text{size}(\mathbf{A})\)</span></p></li>
<li><p>initialize <span class="math notranslate nohighlight">\(\mathbf{y}\leftarrow\text{zeros}(n)\)</span></p></li>
</ol>
<p><strong>Main</strong></p>
<ol class="simple">
<li><p>for <span class="math notranslate nohighlight">\(i\in{1,\dots,n}\)</span>:</p>
<ol class="simple">
<li><p>for <span class="math notranslate nohighlight">\(j\in{1,\dots,m}\)</span>:</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(y_{i}~\leftarrow y_{i} + a_{ji}\times{x_{j}}\)</span></p></li>
</ol>
</li>
</ol>
</li>
</ol>
<p><strong>Return</strong> vector <span class="math notranslate nohighlight">\(\mathbf{y}\)</span></p>
</section>
</div></section>
<section id="matrix-matrix-products">
<h4>Matrix-Matrix products<a class="headerlink" href="#matrix-matrix-products" title="Permalink to this headline">#</a></h4>
<p>Many of the important uses of matrices in engineering practice depend upon the definition of matrix multiplication (<a class="reference internal" href="#defn-matrix-matrix-product">Definition 21</a>):</p>
<div class="proof definition admonition" id="defn-matrix-matrix-product">
<p class="admonition-title"><span class="caption-number">Definition 21 </span> (Matrix-matrix product)</p>
<section class="definition-content" id="proof-content">
<p>Let <span class="math notranslate nohighlight">\(\mathbf{A}\in\mathbb{R}^{m\times{n}}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{B}\in\mathbb{R}^{n\times{p}}\)</span>. The matrix-matrix product <span class="math notranslate nohighlight">\(\mathbf{C} = \mathbf{A}\times\mathbf{B}\)</span> produces the matrix <span class="math notranslate nohighlight">\(\mathbf{C}\in\mathbb{R}^{m\times{p}}\)</span> with elements:</p>
<div class="math notranslate nohighlight" id="equation-eqn-matrix-matrix-product-elements">
<span class="eqno">(34)<a class="headerlink" href="#equation-eqn-matrix-matrix-product-elements" title="Permalink to this equation">#</a></span>\[c_{ij} = \sum_{k=1}^{n}a_{ik}b_{kj}\qquad{i=1,2,\cdots,m~\text{and}~j=1,2,\cdots,p}\]</div>
<p><strong>Compatibility</strong>: The matrices <span class="math notranslate nohighlight">\(\mathbf{A}\in\mathbb{R}^{m\times{n}}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{B}\in\mathbb{R}^{n\times{p}}\)</span> are compatible if the number of columns of <span class="math notranslate nohighlight">\(\mathbf{A}\in\mathbb{R}^{m\times{n}}\)</span> equals the number of rows of <span class="math notranslate nohighlight">\(\mathbf{B}\in\mathbb{R}^{n\times{p}}\)</span>. Otherwise, the matrices are incompatible and cannot be multiplied.</p>
</section>
</div><p>The <em>matrix-matrix multiplication</em> operation can be represented graphically as a series of right matrix-vector products (<a class="reference internal" href="#fig-multiplication-matrix-matrix"><span class="std std-numref">Fig. 14</span></a>):</p>
<figure class="align-default" id="fig-multiplication-matrix-matrix">
<a class="reference internal image-reference" href="../_images/Fig-AB-Matrix-Matrix-Multiplication.pdf"><img alt="../_images/Fig-AB-Matrix-Matrix-Multiplication.pdf" src="../_images/Fig-AB-Matrix-Matrix-Multiplication.pdf" style="height: 380px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 14 </span><span class="caption-text">Schematic of matrix-matrix multiplication. This operation, which produces a matrix product, can be modeled as a series of right matrix-vector products.</span><a class="headerlink" href="#fig-multiplication-matrix-matrix" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>A psuedo code implemetation of <a class="reference internal" href="#defn-matrix-matrix-product">Definition 21</a> is given in <a class="reference internal" href="#algo-matrix-matrix-code">Algorithm 7</a>:</p>
<div class="proof algorithm dropdown admonition" id="algo-matrix-matrix-code">
<p class="admonition-title"><span class="caption-number">Algorithm 7 </span> (Naive Matrix <span class="math notranslate nohighlight">\(\times\)</span> Matrix multiplication)</p>
<section class="algorithm-content" id="proof-content">
<p><strong>Inputs</strong> Matrix <span class="math notranslate nohighlight">\(\mathbf{A}\in\mathbb{R}^{m\times{n}}\)</span>, and matrix <span class="math notranslate nohighlight">\(\mathbf{B}\in\mathbb{R}^{n\times{p}}\)</span></p>
<p><strong>Outputs</strong> Product matrix <span class="math notranslate nohighlight">\(\mathbf{C}\in\mathbb{R}^{m\times{p}}\)</span>.</p>
<p><strong>Initialize</strong></p>
<ol class="simple">
<li><p>initialize <span class="math notranslate nohighlight">\((m, n)\leftarrow\text{size}(\mathbf{A})\)</span></p></li>
<li><p>initialize <span class="math notranslate nohighlight">\((n, p)\leftarrow\text{size}(\mathbf{B})\)</span></p></li>
<li><p>initialize matrix <span class="math notranslate nohighlight">\(\mathbf{C}\leftarrow\text{zeros}(m, p)\)</span></p></li>
</ol>
<p><strong>Main</strong></p>
<ol class="simple">
<li><p>for <span class="math notranslate nohighlight">\(i\in{1,\dots, m}\)</span></p>
<ol class="simple">
<li><p>for <span class="math notranslate nohighlight">\(j\in{1,\dots,p}\)</span></p>
<ol class="simple">
<li><p>for <span class="math notranslate nohighlight">\(k\in{1,\dots,n}\)</span></p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(c_{ij}~\leftarrow~c_{ij} + a_{ik}\times{b_{kj}}\)</span></p></li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
<p><strong>Return</strong> matrix <span class="math notranslate nohighlight">\(\mathbf{C}\)</span></p>
</section>
</div><p>Finally, matrix-matrix products have different properties compared with the product of two scalar numbers:</p>
<ul class="simple">
<li><p><strong>Non-commutativity</strong>: Matrix multiplication is typically <em>not</em> commutative, e.g., <span class="math notranslate nohighlight">\(\mathbf{A}\mathbf{B}\neq\mathbf{B}\mathbf{A}\)</span>.</p></li>
<li><p><strong>Distributivity</strong>: Matrix products are distributive, i.e., <span class="math notranslate nohighlight">\(\mathbf{A}\left(\mathbf{B}+\mathbf{C}\right) = \mathbf{A}\mathbf{B}+\mathbf{A}\mathbf{C}\)</span>.</p></li>
<li><p><strong>Associative</strong>: Matrix products are associative, i.e., <span class="math notranslate nohighlight">\(\mathbf{A}\left(\mathbf{B}\mathbf{C}\right) = \left(\mathbf{A}\mathbf{B}\right)\mathbf{C}\)</span>.</p></li>
<li><p><strong>Transpose</strong>: The transpose of a matrix product is the product of transposes, i.e., <span class="math notranslate nohighlight">\(\left(\mathbf{A}\mathbf{B}\right)^{T} = \mathbf{B}^{T}\mathbf{A}^{T}\)</span>.</p></li>
</ul>
<hr class="docutils" />
</section>
</section>
</section>
<section id="linear-algebraic-equations">
<span id="content-references-soln-laes-start"></span><h2>Linear algebraic equations<a class="headerlink" href="#linear-algebraic-equations" title="Permalink to this headline">#</a></h2>
<p>Linear Algebraic Equations (LAEs) arise in many different engineering fields. In Chemical Engineering, these types of equations naturally arise from steady-state (or time-discretized) balances. Let’s start by asking a simple question, when does a solution exist to the generic system of LAEs of the form:</p>
<div class="math notranslate nohighlight" id="equation-eqn-general-system-laes">
<span class="eqno">(35)<a class="headerlink" href="#equation-eqn-general-system-laes" title="Permalink to this equation">#</a></span>\[\mathbf{A}\mathbf{x} = \mathbf{b}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{A}\in\mathbb{R}^{m\times{n}}\)</span> is the system matrix, <span class="math notranslate nohighlight">\(\mathbf{x}\in\mathbb{R}^{n\times{1}}\)</span> denotes a column vector of unknowns (what we want to solve for), and <span class="math notranslate nohighlight">\(\mathbf{b}\in\mathbb{R}^{m\times{1}}\)</span> is the right-hand side vector:</p>
<ul class="simple">
<li><p><strong>Homogenous system</strong>: A homogeneous system of linear algebraic equations is a system in which the right-hand side vector <span class="math notranslate nohighlight">\(\mathbf{b}= \mathbf{0}\)</span>; every entry in the <span class="math notranslate nohighlight">\(\mathbf{b}\)</span>-vector is equal to zero. The solution set for a homogeneous system is a subspace in linear algebra called the <a class="reference external" href="https://en.wikipedia.org/wiki/Kernel_(linear_algebra)">kernel or nullpsace</a>.</p></li>
<li><p><strong>Non-homogeneous system</strong>: A non-homogeneous system of linear algebraic equations is a system in which at least one entry of the right-hand side vector <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> is non-zero.</p></li>
</ul>
<section id="existence">
<h3>Existence<a class="headerlink" href="#existence" title="Permalink to this headline">#</a></h3>
<p>The existence of a solution to a system of linear equations depends on the righ-hand side vector, the number of equations and the number of variables in the system.</p>
<section id="homogeneous-square-systems">
<h4>Homogeneous square systems<a class="headerlink" href="#homogeneous-square-systems" title="Permalink to this headline">#</a></h4>
<p>For a homogeneous square system of linear equations, the trivial solution <span class="math notranslate nohighlight">\(\mathbf{x}=\mathbf{0}\)</span> always exists. However, a homogeneous square system of linear algebraic equations with <span class="math notranslate nohighlight">\(n\times{n}\)</span> system matrix <span class="math notranslate nohighlight">\(\mathbf{A}\in\mathbb{R}^{n\times{n}}\)</span> and unknown vector <span class="math notranslate nohighlight">\(\mathbf{x}\in\mathbb{R}^{n\times{1}}\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-eqn-homogenous-laes">
<span class="eqno">(36)<a class="headerlink" href="#equation-eqn-homogenous-laes" title="Permalink to this equation">#</a></span>\[\mathbf{A}\mathbf{x} = \mathbf{0}\]</div>
<p>may have other solutions. There is an easy check to determine the existence of other solutions for a homogenous square system
(<a class="reference internal" href="#defn-homogenous-soln-existence">Definition 22</a>):</p>
<div class="proof definition admonition" id="defn-homogenous-soln-existence">
<p class="admonition-title"><span class="caption-number">Definition 22 </span> (Homogenous solution existence)</p>
<section class="definition-content" id="proof-content">
<p>A <span class="math notranslate nohighlight">\(n\times{n}\)</span> homogeneous system of linear algebraic equations will have non-trivial solutions if and only if the system matrix <span class="math notranslate nohighlight">\(\mathbf{A}\in\mathbb{R}^{n\times{n}}\)</span> has a zero determinant:</p>
<div class="math notranslate nohighlight" id="equation-eqn-det-homogenous-cond">
<span class="eqno">(37)<a class="headerlink" href="#equation-eqn-det-homogenous-cond" title="Permalink to this equation">#</a></span>\[\det\left(\mathbf{A}\right) = 0\]</div>
<p>The determinant condition is an easy theoretical test to check for the existence of solutions to a homogenous system of linear algebraic equations. Existence can also be checked by computing the rank: if a matrix is less than full rank, then <span class="math notranslate nohighlight">\(\det{\left(\mathbf{A}\right)}=0\)</span>.</p>
</section>
</div><!-- There are many different ways to compute rank, however, we'll use the [rank](https://docs.julialang.org/en/v1/stdlib/LinearAlgebra/#LinearAlgebra.rank) function in [Julia](https://julialang.org). -->
</section>
<section id="non-homogeneous-square-systems">
<h4>Non-homogeneous square systems<a class="headerlink" href="#non-homogeneous-square-systems" title="Permalink to this headline">#</a></h4>
<p>A non-homogeneous square system of linear algebraic equations with matrix <span class="math notranslate nohighlight">\(\mathbf{A}\in\mathbb{R}^{n\times{n}}\)</span>, unknown vector <span class="math notranslate nohighlight">\(\mathbf{x}\in\mathbb{R}^{n\times{1}}\)</span> and the right-hand-side vector <span class="math notranslate nohighlight">\(\mathbf{b}\in\mathbb{R}^{n\times{1}}\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-eqn-non-homogenous-laes">
<span class="eqno">(38)<a class="headerlink" href="#equation-eqn-non-homogenous-laes" title="Permalink to this equation">#</a></span>\[\mathbf{A}\mathbf{x} = \mathbf{b}\]</div>
<p>will have a unique solution if there exists a matrix <span class="math notranslate nohighlight">\(\mathbf{A}^{-1}\in\mathbb{R}^{n\times{n}}\)</span> such that:</p>
<div class="math notranslate nohighlight" id="equation-eqn-non-homogenous-laes-inverse">
<span class="eqno">(39)<a class="headerlink" href="#equation-eqn-non-homogenous-laes-inverse" title="Permalink to this equation">#</a></span>\[\mathbf{x} = \mathbf{A}^{-1}\mathbf{b}\]</div>
<p>where the <span class="math notranslate nohighlight">\(\mathbf{A}^{-1}\)</span> is called the inverse of the matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> (<a class="reference internal" href="#defn-matrix-inverse">Definition 23</a>):</p>
<div class="proof definition admonition" id="defn-matrix-inverse">
<p class="admonition-title"><span class="caption-number">Definition 23 </span> (Matrix inverse existence)</p>
<section class="definition-content" id="proof-content">
<p>An <span class="math notranslate nohighlight">\(n\times{n}\)</span> square matrix <span class="math notranslate nohighlight">\(\mathbf{A}\in\mathbb{R}^{n\times{n}}\)</span> has an unique inverse <span class="math notranslate nohighlight">\(\mathbf{A}^{-1}\)</span> such that:</p>
<div class="math notranslate nohighlight" id="equation-eqn-matrix-a">
<span class="eqno">(40)<a class="headerlink" href="#equation-eqn-matrix-a" title="Permalink to this equation">#</a></span>\[\mathbf{A}^{-1}\mathbf{A} = \mathbf{A}\mathbf{A}^{-1} = \mathbf{I}\]</div>
<p>if <span class="math notranslate nohighlight">\(\det\left(\mathbf{A}\right)\neq{0}\)</span>. If an inverse exists, the matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is called non-singular; otherwise, <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is singular.</p>
</section>
</div><p>In <a class="reference external" href="https://julialang.org">Julia</a>, the matrix inverse can be calculated using the <a class="reference external" href="https://docs.julialang.org/en/v1/stdlib/LinearAlgebra/#Base.inv-Tuple%7BAbstractMatrix%7D">inv</a> function. Similarly, the <a class="reference external" href="https://numpy.org">NumPy</a> library for <a class="reference external" href="https://www.python.org">Python</a> has a similar <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.linalg.inv.html">inv</a> function.</p>
</section>
</section>
<section id="solutions-approaches">
<span id="content-references-solution-approaches"></span><h3>Solutions approaches<a class="headerlink" href="#solutions-approaches" title="Permalink to this headline">#</a></h3>
<p>Several methods exist to find the solution of square systems of linear equations:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#content-references-gaussian-elimination"><span class="std std-ref">Gaussian elimination</span></a> solves linear equations by using a sequence of operations to reduce the system to an upper triangular form and then back substitution to find the solution.</p></li>
<li><p><a class="reference internal" href="#content-references-iterative-methods"><span class="std std-ref">Iterative solution methods</span></a> are another class of algorithms used to find approximate solutions for large and sparse linear systems of equations. These methods work by starting with an initial guess for the solution and then repeatedly updating the guess until it converges to the actual answer.</p></li>
</ul>
<section id="gaussian-elimination">
<span id="content-references-gaussian-elimination"></span><h4>Gaussian elimination<a class="headerlink" href="#gaussian-elimination" title="Permalink to this headline">#</a></h4>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Gaussian_elimination">Gaussian elimination</a> is an efficient method for solving large square systems of linear algebraic equations. <a class="reference external" href="https://en.wikipedia.org/wiki/Gaussian_elimination">Gaussian elimination</a> is based on “eliminating” variables by adding or subtracting equations (rows) so that the coefficients of one variable are eliminated in subsequent equations. This allows us to solve the remaining variables one at a time until we have a solution for the entire system.</p>
<p>Let’s start exploring this approach by looking at solving a triangular system of equations.</p>
<section id="triangular-systems">
<h5>Triangular systems<a class="headerlink" href="#triangular-systems" title="Permalink to this headline">#</a></h5>
<p>Let’s consider a non-singular <span class="math notranslate nohighlight">\(3\times{3}\)</span> lower triangular system of equations:</p>
<div class="math notranslate nohighlight" id="equation-eqn-triangular-system">
<span class="eqno">(41)<a class="headerlink" href="#equation-eqn-triangular-system" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{pmatrix}
l_{11} &amp; 0 &amp; 0 \\
l_{21} &amp; l_{22} &amp; 0 \\
l_{31} &amp; l_{32} &amp; l_{33}
\end{pmatrix}
\begin{pmatrix}
x_{1} \\
x_{2} \\
x_{3}
\end{pmatrix} = 
\begin{pmatrix}
b_{1} \\
b_{2} \\
b_{3}
\end{pmatrix}\end{split}\]</div>
<p>Since the matrix is non-singular, the diagonal elements <span class="math notranslate nohighlight">\(l_{ii},~i=1,2,3\)</span> are non-zero. This allows us to take advantage of the triangular structure to solve for the unknown <span class="math notranslate nohighlight">\(x_{i}\)</span> values:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
x_{1} &amp; = &amp; b_{1}/l_{11} \\
x_{2} &amp; = &amp; \left(b_{2} - l_{21}x_{1}\right) / l_{22} \\
x_{3} &amp; = &amp; \left(b_{3} - l_{31}x_{1} - l_{32}x_{2}\right) / l_{33}
\end{eqnarray}
\end{split}\]</div>
<p>This idea, called <em>forward substitution</em>, can be extended to any <span class="math notranslate nohighlight">\(n\times{n}\)</span> non-singular lower triangular system (<a class="reference internal" href="#defn-general-forward-sub">Definition 24</a>):</p>
<div class="proof definition admonition" id="defn-general-forward-sub">
<p class="admonition-title"><span class="caption-number">Definition 24 </span> (Forward substitution)</p>
<section class="definition-content" id="proof-content">
<p>Suppose we have an <span class="math notranslate nohighlight">\(n\times{n}\)</span> system (<span class="math notranslate nohighlight">\(n\geq{2}\)</span>) of equations which is lower triangular, and non-singular of the form:</p>
<div class="math notranslate nohighlight" id="equation-eqn-lower-triag-system">
<span class="eqno">(42)<a class="headerlink" href="#equation-eqn-lower-triag-system" title="Permalink to this equation">#</a></span>\[\mathbf{L}\mathbf{x} = \mathbf{b}\]</div>
<p>Then, the solution of Eqn. <a class="reference internal" href="#equation-eqn-lower-triag-system">(42)</a> is given by:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
x_{1} &amp; = &amp; \frac{b_{1}}{l_{11}} \\
x_{i} &amp; = &amp; \frac{1}{l_{ii}}\left(b_{i} - \sum_{j=1}^{i-1}l_{ij}x_{j}\right)\qquad{i=2,\dots,n}
\end{eqnarray}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(l_{ii}\neq{0}\)</span>. The global operation count for this appraoch is <span class="math notranslate nohighlight">\(n^{2}\)</span> floating point operations (flops).</p>
</section>
</div><p>Alternatively, we can take a similar apprach with an upper triangular system,  called <em>backward substituion</em>, to solve for
unknow solution vector <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> (<a class="reference internal" href="#defn-general-backward-sub">Definition 25</a>):</p>
<div class="proof definition admonition" id="defn-general-backward-sub">
<p class="admonition-title"><span class="caption-number">Definition 25 </span> (Backward substitution)</p>
<section class="definition-content" id="proof-content">
<p>Suppose we have an <span class="math notranslate nohighlight">\(n\times{n}\)</span> system (<span class="math notranslate nohighlight">\(n\geq{2}\)</span>) of equations which is upper triangular, and non-singular of the form:</p>
<div class="math notranslate nohighlight" id="equation-eqn-upper-triag-system">
<span class="eqno">(43)<a class="headerlink" href="#equation-eqn-upper-triag-system" title="Permalink to this equation">#</a></span>\[\mathbf{U}\mathbf{x} = \mathbf{b}\]</div>
<p>Then, the solution of Eqn. <a class="reference internal" href="#equation-eqn-upper-triag-system">(43)</a> is given by:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
x_{n} &amp; = &amp; \frac{b_{n}}{u_{nn}} \\
x_{i} &amp; = &amp; \frac{1}{u_{ii}}\left(b_{i} - \sum_{j=i+1}^{n}u_{ij}x_{j}\right)\qquad{i=n-1,\dots,1}
\end{eqnarray}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(u_{ii}\neq{0}\)</span>. The global operation count for this appraoch is <span class="math notranslate nohighlight">\(n^{2}\)</span> floating point operations (flops).</p>
</section>
</div><!-- Since we talking about [Gaussian elimination](https://en.wikipedia.org/wiki/Gaussian_elimination), which produces an upper triangular matrix $\mathbf{U}$, let's review a _backward substitution_ algorithm to estimate the unknown vector $\mathbf{x}$ given a non-singular upper triangular $\mathbf{U}$ and right-hand-side vector $\mathbf{b}$ based on {prf:ref}`defn-general-backward-sub`: -->
<p>Solving a lower or upper triangular system can quickly be done with a substitution approach. However, upper (or lower) triangular systems rarely arise naturally in applications. So why do we care about triangular systems?</p>
</section>
<section id="row-reduction-approaches">
<h5>Row reduction approaches<a class="headerlink" href="#row-reduction-approaches" title="Permalink to this headline">#</a></h5>
<p>Converting a matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> to an upper triangular form involves performing a sequence of elementary row operations to transform the matrix into a form where all entries below the main diagonal are zero. This is typically done by row swapping, scaling, and adding rows. The goal is to create a matrix where each row’s leading coefficient (the first non-zero element) is <code class="docutils literal notranslate"><span class="pre">1</span></code>, and all the other entries in that column are <code class="docutils literal notranslate"><span class="pre">0</span></code>. This is achieved by using the leading coefficient of one row to eliminate the corresponding entries in the other rows.</p>
<p>Let’s walk through a simple example to illustrate the steps involved with <a class="reference external" href="https://en.wikipedia.org/wiki/Row_echelon_form">row reduction</a>; consider the solution of the 3<span class="math notranslate nohighlight">\(\times\)</span>3 system:</p>
<div class="math notranslate nohighlight" id="equation-eqn-ge-test-system">
<span class="eqno">(44)<a class="headerlink" href="#equation-eqn-ge-test-system" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{bmatrix}
2 &amp; -1 &amp; 0 \\
-1 &amp; 2 &amp; -1 \\
0 &amp; -1 &amp; 2
\end{bmatrix}
\begin{pmatrix}
x_{1} \\
x_{2} \\
x_{3}
\end{pmatrix} =
\begin{pmatrix}
0 \\
1 \\
0
\end{pmatrix}\end{split}\]</div>
<p><strong>Step 1</strong>: Form the augemented matrix <span class="math notranslate nohighlight">\(\bar{\mathbf{A}}\)</span> which is defined as the matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> with the righ-hand-side vector <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> appended as the last column:</p>
<div class="math notranslate nohighlight" id="equation-eqn-augmented-array-a">
<span class="eqno">(45)<a class="headerlink" href="#equation-eqn-augmented-array-a" title="Permalink to this equation">#</a></span>\[\begin{split}\bar{\mathbf{A}} = \begin{bmatrix}
2 &amp; -1 &amp; 0 &amp;\bigm| &amp; 0 \\
-1 &amp; 2 &amp; -1 &amp;\bigm| &amp; 1 \\
0 &amp; -1 &amp; 2 &amp;\bigm| &amp; 0
\end{bmatrix}\end{split}\]</div>
<p><strong>Step 2</strong>: Perform row operations to reduce the augmented matrix <span class="math notranslate nohighlight">\(\bar{\mathbf{A}}\)</span> to <a class="reference external" href="https://en.wikipedia.org/wiki/Row_echelon_form">the upper triangular row echelon form</a>. We can perform row operations:</p>
<ul class="simple">
<li><p><em>Swapping</em>: We can interchange the order of the rows to get zeros below the main diagonal.</p></li>
<li><p><em>Scaling</em>:  If the first nonzero entry of row <span class="math notranslate nohighlight">\(R_{i}\)</span> is <span class="math notranslate nohighlight">\(\lambda\)</span>, we can convert to <span class="math notranslate nohighlight">\(1\)</span> through the operation: <span class="math notranslate nohighlight">\(R_{i}\leftarrow{1/\lambda}R_{i}\)</span></p></li>
<li><p><em>Addition and subtraction</em>: For any nonzero entry below the top one, use an elementary row operation to change it to zero; If two rows <span class="math notranslate nohighlight">\(R_{i}\)</span> and <span class="math notranslate nohighlight">\(R_{j}\)</span> have nonzero entries in column <span class="math notranslate nohighlight">\(k\)</span>, we can transform the (j,k) entry into a zero using <span class="math notranslate nohighlight">\(R_{j}\leftarrow{R}_{j} - (a_{jk}/a_{ik})R_{i}\)</span>.</p></li>
</ul>
<p>In Eqn <a class="reference internal" href="#equation-eqn-augmented-array-a">(45)</a>, the first row and column entry are non-zero, and interchanging rows does not improve our progress. However, the leading non-zero coefficient is not <code class="docutils literal notranslate"><span class="pre">1</span></code>; thus, let’s use a scaling row operation:</p>
<div class="math notranslate nohighlight" id="equation-eqn-augmented-array-a-step3">
<span class="eqno">(46)<a class="headerlink" href="#equation-eqn-augmented-array-a-step3" title="Permalink to this equation">#</a></span>\[\begin{split}\bar{\mathbf{A}} = \begin{bmatrix}
2 &amp; -1 &amp; 0 &amp;\bigm| &amp; 0 \\
-1 &amp; 2 &amp; -1 &amp;\bigm| &amp; 1 \\
0 &amp; -1 &amp; 2 &amp;\bigm| &amp; 0
\end{bmatrix} \stackrel{R_{1}\leftarrow(1/2)R_{1}}{\longrightarrow}
\begin{bmatrix}
1 &amp; -0.5 &amp; 0 &amp;\bigm| &amp; 0 \\
-1 &amp; 2 &amp; -1 &amp;\bigm| &amp; 1 \\
0 &amp; -1 &amp; 2 &amp;\bigm| &amp; 0
\end{bmatrix}\end{split}\]</div>
<p>We now eliminate the coefficient below the top row; in this case <span class="math notranslate nohighlight">\(i=1\)</span>, <span class="math notranslate nohighlight">\(j=1\)</span> and <span class="math notranslate nohighlight">\(k=1\)</span> which gives the operation: <span class="math notranslate nohighlight">\(R_{2}\leftarrow{R}_{2} + R_{1}\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-eqn-augmented-array-a-step4">
<span class="eqno">(47)<a class="headerlink" href="#equation-eqn-augmented-array-a-step4" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{bmatrix}
1 &amp; -0.5 &amp; 0 &amp;\bigm| &amp; 0 \\
-1 &amp; 2 &amp; -1 &amp;\bigm| &amp; 1 \\
0 &amp; -1 &amp; 2 &amp;\bigm| &amp; 0
\end{bmatrix}
\stackrel{R_{2}\leftarrow{R_{2}+R_{1}}}{\longrightarrow}
\begin{bmatrix}
1 &amp; -0.5 &amp; 0 &amp;\bigm| &amp; 0 \\
0 &amp; 1.5 &amp; -1 &amp;\bigm| &amp; 1 \\
0 &amp; -1 &amp; 2 &amp;\bigm| &amp; 0
\end{bmatrix}\end{split}\]</div>
<p>The leading coefficient of row 3 was already zero; thus, we have completed the row reduction operations for row 1. Moving to row 2, the first non-zero coefficient is in column 2. Scale row 2, and then subtract from row 3, etc.</p>
<p>While the logic underlying the row reduction of the matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> to the upper triangular row-echelon form <span class="math notranslate nohighlight">\(\mathbf{U}\)</span> seems simple, the implementation of a general, efficient row reduction function can be complicated; let’s develop a naive implementation of a row reduction procedure (<a class="reference internal" href="#algo-ge-basic">Algorithm 8</a>):</p>
<div class="proof algorithm dropdown admonition" id="algo-ge-basic">
<p class="admonition-title"><span class="caption-number">Algorithm 8 </span> (Naive Row Reduction)</p>
<section class="algorithm-content" id="proof-content">
<p><strong>Input</strong>:
Matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>, the vector <span class="math notranslate nohighlight">\(\mathbf{b}\)</span></p>
<p><strong>Output</strong>: solution <span class="math notranslate nohighlight">\(\hat{\mathbf{x}}\)</span></p>
<p><strong>Initialize</strong>:</p>
<ol class="simple">
<li><p>set <span class="math notranslate nohighlight">\((n,m)\leftarrow\text{size}(\mathbf{A})\)</span></p></li>
<li><p>set <span class="math notranslate nohighlight">\(\bar{\mathbf{A}}\leftarrow\text{augment}(\mathbf{A},\mathbf{b})\)</span></p></li>
</ol>
<p><strong>Main</strong></p>
<ol class="simple">
<li><p>for <span class="math notranslate nohighlight">\(i\in{1}\dots{n-1}\)</span></p>
<ol class="simple">
<li><p>set <span class="math notranslate nohighlight">\(\text{pivot}\leftarrow{a_{ii}}\)</span></p></li>
<li><p>set <span class="math notranslate nohighlight">\(\text{pivotRow}\leftarrow{i}\)</span></p></li>
<li><p>for <span class="math notranslate nohighlight">\(j\in{i+1}\dots{n}\)</span></p>
<ol class="simple">
<li><p>if <span class="math notranslate nohighlight">\(\text{abs}(\bar{a}_{ji}) &gt; \text{abs}(\text{pivot})\)</span></p>
<ol class="simple">
<li><p>set <span class="math notranslate nohighlight">\(\text{pivot}\leftarrow\bar{a}_{ji}\)</span></p></li>
<li><p>set <span class="math notranslate nohighlight">\(\text{pivotRow}\leftarrow{j}\)</span></p></li>
</ol>
</li>
</ol>
</li>
<li><p>set <span class="math notranslate nohighlight">\(\bar{\mathbf{A}}\leftarrow\text{swap}(\bar{\mathbf{A}},i,\text{pivotRow})\)</span></p></li>
<li><p>for <span class="math notranslate nohighlight">\(j\in{i+1}\dots{n}\)</span></p>
<ol class="simple">
<li><p>set <span class="math notranslate nohighlight">\(\text{factor}\leftarrow{a_{ji}}/\text{pivot}\)</span></p></li>
<li><p>for <span class="math notranslate nohighlight">\(k\in{1,\dots,m}\)</span></p>
<ol class="simple">
<li><p>set <span class="math notranslate nohighlight">\(a_{jk}\leftarrow{a_{jk}} - \text{factor}\times{a_{ik}}\)</span></p></li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
<p><strong>Return</strong> <span class="math notranslate nohighlight">\(\text{row reduced}~\bar{\mathbf{A}}\)</span></p>
</section>
</div><p><strong>Step 3</strong>: Solve for the unknown values <span class="math notranslate nohighlight">\(x_{1},\dots,x_{n}\)</span> using <em>back substitution</em>:</p>
<div class="math notranslate nohighlight" id="equation-eqn-back-sub-matrix-a">
<span class="eqno">(48)<a class="headerlink" href="#equation-eqn-back-sub-matrix-a" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{bmatrix}
1 &amp; -0.5 &amp; 0 &amp;\bigm| &amp; 0 \\
0 &amp; 1 &amp; -0.66 &amp;\bigm| &amp; 0.66 \\
0 &amp; 0 &amp; 1 &amp;\bigm| &amp; 0.49
\end{bmatrix}\end{split}\]</div>
<p>This system in Eqn. <a class="reference internal" href="#equation-eqn-back-sub-matrix-a">(48)</a> is in row reduced form; thus, it can now be solved using <em>back substitution</em>. Based on the <a class="reference internal" href="#defn-general-backward-sub">Definition 25</a>, we implemented a back substitution routine <a class="reference internal" href="#algo-backward-substituion">Algorithm 9</a>:</p>
<div class="proof algorithm dropdown admonition" id="algo-backward-substituion">
<p class="admonition-title"><span class="caption-number">Algorithm 9 </span> (Backward substituion)</p>
<section class="algorithm-content" id="proof-content">
<p><strong>Inputs</strong> Upper triangular matrix <span class="math notranslate nohighlight">\(\mathbf{U}\)</span>, column vector <span class="math notranslate nohighlight">\(\mathbf{b}\)</span></p>
<p><strong>Outputs</strong> solution vector <span class="math notranslate nohighlight">\(\mathbf{x}\)</span></p>
<p><strong>Initialize</strong></p>
<ol class="simple">
<li><p>set <span class="math notranslate nohighlight">\(n\leftarrow\text{nrows}\left(\mathbf{U}\right)\)</span></p></li>
<li><p>set <span class="math notranslate nohighlight">\(\mathbf{x}\leftarrow\text{zeros}\left(n\right)\)</span></p></li>
<li><p>set <span class="math notranslate nohighlight">\(x_n\leftarrow{b_n/u_{nn}}\)</span></p></li>
</ol>
<p><strong>Main</strong></p>
<ol class="simple">
<li><p>for <span class="math notranslate nohighlight">\(i\in{n-1\dots,1}\)</span></p>
<ol class="simple">
<li><p>set <span class="math notranslate nohighlight">\(\text{sum}\leftarrow{0}\)</span></p></li>
<li><p>for <span class="math notranslate nohighlight">\(j\in{i+1,\dots,n}\)</span></p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(\text{sum}\leftarrow\text{sum} + u_{ij}\times{x_{j}}\)</span></p></li>
</ol>
</li>
<li><p><span class="math notranslate nohighlight">\(x_{i}\leftarrow\left(1/u_{ii}\right)\times\left(b_{i} - \text{sum}\right)\)</span></p></li>
</ol>
</li>
</ol>
<p><strong>Return</strong> solution vector <span class="math notranslate nohighlight">\(\mathbf{x}\)</span></p>
</section>
</div><p>Now that we have row reduction and back substitution algorithms, let’s look at a few examples. First,  consider the solution of a square system of equations that arise from mole balance with a single first-order decay reaction (<a class="reference internal" href="#example-time-discretized-decay">Example 19</a>):</p>
<div class="proof example dropdown admonition" id="example-time-discretized-decay">
<p class="admonition-title"><span class="caption-number">Example 19 </span> (First-order decay)</p>
<section class="example-content" id="proof-content">
<p>Setup a system of linear algebraic equations whose solution describes the concentration as a function of time for a compound <span class="math notranslate nohighlight">\(A\)</span> that undergoes first-order decay in a well-mixed batch reactor. The concentration balance for compound <span class="math notranslate nohighlight">\(A\)</span> is given by:</p>
<div class="math notranslate nohighlight" id="equation-eqn-balance-concentration">
<span class="eqno">(49)<a class="headerlink" href="#equation-eqn-balance-concentration" title="Permalink to this equation">#</a></span>\[\frac{dC_{A}}{dt} = -\kappa{C_{A}}\]</div>
<p>where <span class="math notranslate nohighlight">\(\kappa\)</span> denotes the first-order rate constant governing the rate of decay (units: 1/time), and the initial condition is given by <span class="math notranslate nohighlight">\(C_{A,0}\)</span>.
Let <span class="math notranslate nohighlight">\(C_{A,0} = 10~\text{mmol/L}\)</span>, <span class="math notranslate nohighlight">\(\kappa = 0.5~\text{hr}^{-1}\)</span> and <span class="math notranslate nohighlight">\(h = 0.1\)</span>.</p>
<p><strong>Solution</strong>: Let’s discretize the concentration balance using a <a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference">forward finte difference</a> approximation of the time derivatrive:</p>
<div class="math notranslate nohighlight" id="equation-eqn-ca-recursion">
<span class="eqno">(50)<a class="headerlink" href="#equation-eqn-ca-recursion" title="Permalink to this equation">#</a></span>\[C_{A,j+1} = C_{A,j} - h\kappa{C_{A,j}}\]</div>
<p>where <span class="math notranslate nohighlight">\(h\)</span> denotes the time step-size, and <span class="math notranslate nohighlight">\(C_{A,\star}\)</span> denotes the concentration of <span class="math notranslate nohighlight">\(A\)</span> at time-step <span class="math notranslate nohighlight">\(\star\)</span>. Starting with <span class="math notranslate nohighlight">\(j=0\)</span>,
Eqn <a class="reference internal" href="#equation-eqn-ca-recursion">(50)</a> can be used to construct a <span class="math notranslate nohighlight">\(T{\times}T\)</span> matrix where each rows is a seperate time-step:</p>
<div class="math notranslate nohighlight" id="equation-eqn-ca-system-txt">
<span class="eqno">(51)<a class="headerlink" href="#equation-eqn-ca-system-txt" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{pmatrix}
1 &amp; 0 &amp; \dots &amp; 0 \\
(\kappa{h} - 1) &amp; 1 &amp; \dots &amp; 0 \\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
0 &amp; \dots &amp; (\kappa{h} - 1) &amp; 1
\end{pmatrix}
\begin{pmatrix}
C_{A,1} \\
C_{A,2} \\
\vdots \\
C_{A,T}
\end{pmatrix} = 
\begin{pmatrix}
C_{A,0}\left(1-h\kappa\right) \\
0 \\
\vdots \\
0 
\end{pmatrix}\end{split}\]</div>
</section>
</div></section>
</section>
<section id="iterative-solution-methods">
<span id="content-references-iterative-methods"></span><h4>Iterative solution methods<a class="headerlink" href="#iterative-solution-methods" title="Permalink to this headline">#</a></h4>
<p>Iterative methods work by improving an initial guess of the solution until a desired level of accuracy is achieved. Commonly used iterative methods include <a class="reference internal" href="#content-references-jacobi-iterative-method"><span class="std std-ref">Jacobi’s method</span></a> and the
<a class="reference internal" href="#content-references-gauss-seidel-method"><span class="std std-ref">Gauss-Seidel method</span></a>.</p>
<ul class="simple">
<li><p><strong>At each iteration</strong>: an iterative method uses the current estimate of the solution to generate a new estimate closer to the actual answer. This process continues until the solution converges to a desired accuracy level, typically measured by a tolerance parameter.</p></li>
</ul>
<p>The basic strategy of an iterative method is shown in <a class="reference internal" href="#obs-basic-iterative-method-outline">Observation 3</a>:</p>
<!-- 
These methods work by starting with an initial guess for the solution and then iteratively improving the guess until it converges on the actual answer. Several types of iterative methods can be used to solve linear algebraic equations, including Jacobi’s and the Gauss-Seidel methods. These methods all involve iteratively updating the estimates of the variables in the system of equations until the solution is found.

One of the advantages of iterative methods is that they can be more efficient than direct methods for solving large, sparse systems of linear equations. However, they can also be more sensitive to the initial guess and may require more iterations to converge on the solution. -->
<!-- 
An iterative method takes an initial solution guess, and refines it by substituting
this guess back into into the linear algebraic equations. The guess is then updated over and over again until either we exhaust the number of iterations we can take, or we converge to a solution. Two key iterative methods are: [Jacobi Iteration](https://en.wikipedia.org/wiki/Jacobi_method) and
[Gauss-Seidel](https://en.wikipedia.org/wiki/Gauss–Seidel_method). The central difference between these two methods is how they update the best estimate of a solution at any given iteration.  -->
<div class="proof observation admonition" id="obs-basic-iterative-method-outline">
<p class="admonition-title"><span class="caption-number">Observation 3 </span> (Basic iterative strategy)</p>
<section class="observation-content" id="proof-content">
<p>Suppose we have a square system of linear algebraic equations:</p>
<div class="math notranslate nohighlight">
\[\mathbf{A}\mathbf{x} = \mathbf{b}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{A}\in\mathbb{R}^{n\times{n}}\)</span> is the system matrix, <span class="math notranslate nohighlight">\(\mathbf{x}\in\mathbb{R}^{n\times{1}}\)</span> is a vector of unknowns, and <span class="math notranslate nohighlight">\(\mathbf{b}\in\mathbb{R}^{n\times{1}}\)</span> is the right-hand-side vector. Starting with equation <span class="math notranslate nohighlight">\(i\)</span>:</p>
<div class="math notranslate nohighlight">
\[\sum_{j = 1}^{n}a_{ij}x_{j} = b_{i}\qquad{i=1,2,\cdots{n}}\]</div>
<p>we solve for an estimate of the ith unknown value <span class="math notranslate nohighlight">\(\hat{x}_{i}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\hat{x}_{i}=\frac{1}{a_{ii}}\bigl(b_{i}-\sum_{j=1,i}^{n}a_{ij}x_{j}\bigr)\qquad{i=1,2,\cdots{n}}\]</div>
<p>where <span class="math notranslate nohighlight">\(\sum_{j=1,i}^{n}\)</span> does not include index <span class="math notranslate nohighlight">\(i\)</span>. What we do with the estimated value of <span class="math notranslate nohighlight">\(\hat{x}_{i}\)</span> is the difference between Jacobi’s and Gauss-Seidel’s methods.</p>
</section>
</div><p>Iterative solution methods are used to solve large systems of linear equations where direct methods (such as Gaussian elimination) are impractical due to their computational cost.</p>
<section id="jacobi-s-method">
<span id="content-references-jacobi-iterative-method"></span><h5>Jacobi’s method<a class="headerlink" href="#jacobi-s-method" title="Permalink to this headline">#</a></h5>
<p>Jacobi’s method <strong>batch updates</strong> the estimate of <span class="math notranslate nohighlight">\(x_{i}\)</span> at the <em>end</em> of each iteration. Let the estimate of the value of <span class="math notranslate nohighlight">\(x_{i}\)</span> at iteration k be <span class="math notranslate nohighlight">\(\hat{x}_{i,k}\)</span>. Then, the solution estimate at the next iteration <span class="math notranslate nohighlight">\(\hat{x}_{i,k+1}\)</span> is given by:</p>
<div class="math notranslate nohighlight" id="equation-eqn-jacobi-iteration">
<span class="eqno">(52)<a class="headerlink" href="#equation-eqn-jacobi-iteration" title="Permalink to this equation">#</a></span>\[\hat{x}_{i,k+1}=\frac{1}{a_{ii}}\bigl(b_{i}-\sum_{j=1,i}^{n}a_{ij}\hat{x}_{j,k}\bigr)\qquad{i=1,2,\cdots,n}\]</div>
<p>In the Jacobi method, the estimate for all variables from the previous iteration is used, and we wait to update the solution until we have processed all <span class="math notranslate nohighlight">\(i=1,2,\cdots,n\)</span> equations. We continue to iterate until the change in the estimated solution does not change, i.e., the <em>distance</em> between the solution estimated at <span class="math notranslate nohighlight">\(k\)</span> and <span class="math notranslate nohighlight">\(k+1\)</span> is below some specified tolerance.</p>
<p>Let’s look at the pseudo-code for Jacobi’s method (<a class="reference internal" href="#algo-jacobi-iteration">Algorithm 10</a>):</p>
<div class="proof algorithm dropdown admonition" id="algo-jacobi-iteration">
<p class="admonition-title"><span class="caption-number">Algorithm 10 </span> (Jacobi iteration)</p>
<section class="algorithm-content" id="proof-content">
<p><strong>Input</strong>:
Matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>, the vector <span class="math notranslate nohighlight">\(\mathbf{b}\)</span>, guess <span class="math notranslate nohighlight">\(\mathbf{x}_{o}\)</span>, tolerance <span class="math notranslate nohighlight">\(\epsilon\)</span>, maximum iterations <span class="math notranslate nohighlight">\(\mathcal{M}_{\infty}\)</span>.</p>
<p><strong>Output</strong>: solution <span class="math notranslate nohighlight">\(\hat{\mathbf{x}}\)</span></p>
<p><strong>Initialize</strong>:</p>
<ol class="simple">
<li><p>set <span class="math notranslate nohighlight">\(n\leftarrow\)</span>length(<span class="math notranslate nohighlight">\(\mathbf{b}\)</span>)</p></li>
<li><p>set <span class="math notranslate nohighlight">\(\hat{\mathbf{x}}\leftarrow\mathbf{x}_{o}\)</span></p></li>
</ol>
<p><strong>Main</strong></p>
<ol class="simple">
<li><p>for <span class="math notranslate nohighlight">\(i\in{1}\dots\mathcal{M}_{\infty}\)</span></p>
<ol class="simple">
<li><p>set <span class="math notranslate nohighlight">\(\mathbf{x}^{\prime}\leftarrow\text{zeros}(n,1)\)</span></p></li>
<li><p>for <span class="math notranslate nohighlight">\(j\in{1}\dots{n}\)</span></p>
<ol class="simple">
<li><p>set <span class="math notranslate nohighlight">\(s\leftarrow{0}\)</span></p></li>
<li><p>for <span class="math notranslate nohighlight">\(k\in{1}\dots{n}\)</span></p>
<ol class="simple">
<li><p>if <span class="math notranslate nohighlight">\(k\neq{j}\)</span></p>
<ol class="simple">
<li><p>set <span class="math notranslate nohighlight">\(s\leftarrow{s} + a_{jk}\times\hat{x}_{k}\)</span></p></li>
</ol>
</li>
</ol>
</li>
<li><p>set <span class="math notranslate nohighlight">\(x^{\prime}_{j}\leftarrow{a^{-1}_{jj}}\times\left(b_{j} - s\right)\)</span></p></li>
</ol>
</li>
<li><p>if <span class="math notranslate nohighlight">\(||\mathbf{x}^{\prime} - \hat{\mathbf{x}}|| &lt; \epsilon\)</span></p>
<ol class="simple">
<li><p>return <span class="math notranslate nohighlight">\(\hat{\mathbf{x}}\)</span></p></li>
</ol>
</li>
<li><p>else</p>
<ol class="simple">
<li><p>set <span class="math notranslate nohighlight">\(\hat{\mathbf{x}}\leftarrow\mathbf{x}^{\prime}\)</span></p></li>
</ol>
</li>
</ol>
</li>
<li><p>return <span class="math notranslate nohighlight">\(\hat{\mathbf{x}}\)</span></p></li>
</ol>
</section>
</div><!-- the Gauss-Seidel method works by iteratively improving an initial guess for the solution to the system of equations. At each iteration, the method updates the values of the variables using the current estimates for the other variables.  -->
</section>
<section id="gauss-seidel-method">
<span id="content-references-gauss-seidel-method"></span><h5>Gauss-Seidel method<a class="headerlink" href="#gauss-seidel-method" title="Permalink to this headline">#</a></h5>
<p>The Gauss-Seidel method <strong>live updates</strong> the best estimate of <span class="math notranslate nohighlight">\(\hat{x}_{i}\)</span> <em>during</em> the processing of equations <span class="math notranslate nohighlight">\(i=1,\cdots,n\)</span>. The Gauss-Seidel update procedure generally leads to better convergence properties than the Jacobi method. Let the estimate for variable <span class="math notranslate nohighlight">\(i\)</span> at iteration <span class="math notranslate nohighlight">\(k\)</span> be <span class="math notranslate nohighlight">\(\hat{x}_{i,k}\)</span>. Then, the solution estimate at the next iteration <span class="math notranslate nohighlight">\(\hat{x}_{i,k+1}\)</span> is given by:</p>
<div class="math notranslate nohighlight" id="equation-eqn-gauss-seidel-iteration">
<span class="eqno">(53)<a class="headerlink" href="#equation-eqn-gauss-seidel-iteration" title="Permalink to this equation">#</a></span>\[\hat{x}_{i,k+1}=\frac{1}{a_{ii}}\bigl(b_{i}-\sum_{j=1}^{i-1}a_{ij}\hat{x}_{j,k+1}-\sum_{j=i+1}^{n}a_{ij}\hat{x}_{j,k}\bigr)\qquad{i=1,2,\cdots,n}\]</div>
<p>We continue to iterate until the change in the estimated solution does not change, i.e., the <em>distance</em> between the solution estimated at <span class="math notranslate nohighlight">\(k\)</span> and <span class="math notranslate nohighlight">\(k+1\)</span> is below some specified tolerance.</p>
<p>Let’s look at a pseudo-code for the Gauss-Seidel method (<a class="reference internal" href="#algo-gauss-seidel-method">Algorithm 11</a>):</p>
<div class="proof algorithm dropdown admonition" id="algo-gauss-seidel-method">
<p class="admonition-title"><span class="caption-number">Algorithm 11 </span> (Gauss-Seidel method)</p>
<section class="algorithm-content" id="proof-content">
<p><strong>Input</strong>:
Matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>, the vector <span class="math notranslate nohighlight">\(\mathbf{b}\)</span>, guess <span class="math notranslate nohighlight">\(\mathbf{x}_{o}\)</span>, tolerance <span class="math notranslate nohighlight">\(\epsilon\)</span>, maximum iterations <span class="math notranslate nohighlight">\(\mathcal{M}_{\infty}\)</span>.</p>
<p><strong>Output</strong>: solution <span class="math notranslate nohighlight">\(\hat{\mathbf{x}}\)</span>, converged flag</p>
<p><strong>Initialize</strong>:</p>
<ol class="simple">
<li><p>set <span class="math notranslate nohighlight">\(n\leftarrow\)</span>length(<span class="math notranslate nohighlight">\(\mathbf{b}\)</span>)</p></li>
<li><p>set <span class="math notranslate nohighlight">\(\hat{\mathbf{x}}\leftarrow\mathbf{x}_{o}\)</span></p></li>
<li><p>set converged <span class="math notranslate nohighlight">\(\leftarrow\)</span> false</p></li>
</ol>
<p><strong>Main</strong></p>
<ol class="simple">
<li><p>for <span class="math notranslate nohighlight">\(i\in{1}\dots\mathcal{M}_{\infty}\)</span></p>
<ol class="simple">
<li><p>set <span class="math notranslate nohighlight">\(\mathbf{x}^{\prime}\leftarrow\text{zeros}(n,1)\)</span></p></li>
<li><p>for <span class="math notranslate nohighlight">\(j\in{1}\dots{n}\)</span></p>
<ol class="simple">
<li><p>compute new value <span class="math notranslate nohighlight">\(x_{j}^{\prime}\)</span></p></li>
</ol>
</li>
<li><p>if <span class="math notranslate nohighlight">\(||\mathbf{x}^{\prime} - \hat{\mathbf{x}}|| &lt; \epsilon\)</span></p>
<ol class="simple">
<li><p>set converged <span class="math notranslate nohighlight">\(\leftarrow\)</span> true</p></li>
<li><p>break</p></li>
</ol>
</li>
<li><p>set <span class="math notranslate nohighlight">\(\hat{\mathbf{x}}\leftarrow\mathbf{x}^{\prime}\)</span></p></li>
</ol>
</li>
<li><p>return <span class="math notranslate nohighlight">\(\hat{\mathbf{x}}\)</span>, converged</p></li>
</ol>
</section>
</div></section>
<section id="successive-overrelaxation">
<h5>Successive Overrelaxation<a class="headerlink" href="#successive-overrelaxation" title="Permalink to this headline">#</a></h5>
<p>Successive Overrelaxation methods (SORMs) are modified versions of Gauss-Seidel, where the best estimate of <span class="math notranslate nohighlight">\(x_{i}\)</span> is further modified
before proceeding to the evaluation of the next equations. Suppose we define the best estimate
for the value of <span class="math notranslate nohighlight">\(x_{i}\)</span> at iteration k as <span class="math notranslate nohighlight">\(\hat{x}_{i,k}\)</span>. Then <em>before</em> processing the next Gauss-Seidel type step we update the best guess for <span class="math notranslate nohighlight">\(x_{i}\)</span> using the rule:</p>
<div class="math notranslate nohighlight">
\[\hat{x}_{i,k}=\lambda\hat{x}_{i,k}+\left(1-\lambda\right)\hat{x}_{i,k-1}\qquad{i=1,2,\cdots,n}\]</div>
<p>where <span class="math notranslate nohighlight">\(\lambda\)</span> is an adjustable parameter governed by <span class="math notranslate nohighlight">\(0&lt;\lambda\leq{2}\)</span>. The value of <span class="math notranslate nohighlight">\(\lambda\)</span> can dramatically speed-up <em>or</em>
slow-down the convergence to the correct solution, so care should be taken when choosing it.
The value of <span class="math notranslate nohighlight">\(\lambda\)</span> can be in one of three regimes:</p>
<ul class="simple">
<li><p>Underrelaxation <span class="math notranslate nohighlight">\(0&lt;\lambda&lt;1\)</span>: Can help solve systems that have problematic convergence</p></li>
<li><p>Nominal <span class="math notranslate nohighlight">\(\lambda=1\)</span>: Regular Gauss-Seidel algorithm</p></li>
<li><p>Overrelaxation <span class="math notranslate nohighlight">\(1&lt;\lambda\leq{2}\)</span>: This regime will increase the rate of convergence provided the algorithm can converge</p></li>
</ul>
</section>
</section>
<section id="convergence-of-iterative-methods">
<h4>Convergence of iterative methods<a class="headerlink" href="#convergence-of-iterative-methods" title="Permalink to this headline">#</a></h4>
<p>A sufficient condition for the convergence of <a class="reference external" href="https://en.wikipedia.org/wiki/Jacobi_method">Jacobi</a> or <a class="reference external" href="https://en.wikipedia.org/wiki/Gauss%E2%80%93Seidel_method">Gauss-Seidel iteration</a> is the well known <a class="reference external" href="https://en.wikipedia.org/wiki/Diagonally_dominant_matrix">diagonal dominance condition</a>:</p>
<div class="math notranslate nohighlight" id="equation-eqn-diagonal-dom">
<span class="eqno">(54)<a class="headerlink" href="#equation-eqn-diagonal-dom" title="Permalink to this equation">#</a></span>\[\sum_{j=1,i}^{n}\lvert{a_{ij}}\rvert&lt;\lvert{a_{ii}}\rvert\qquad\forall{i}\]</div>
<p>Diagonal dominance is a sufficient (but not necessary) condition for convergence (a measure of the distance between the current
best solution and the actual solution) of an iterative method. Of course, this condition says nothing above the rate of convergence.</p>
<ul class="simple">
<li><p>Diagonal dominance, as shown on Eqn. <a class="reference internal" href="#equation-eqn-diagonal-dom">(54)</a>, is a matrix property where the absolute value of the diagonal element of each row is greater than or equal to the sum of the absolute values of the other elements in that row. A matrix that satisfies this property is said to be diagonally dominant.</p></li>
<li><p>When a matrix is diagonally dominant, iterative methods for solving linear systems of equations, such as the <a class="reference external" href="https://en.wikipedia.org/wiki/Jacobi_method">Jacobi</a> or <a class="reference external" href="https://en.wikipedia.org/wiki/Gauss%E2%80%93Seidel_method">Gauss-Seidel methods</a>, converge faster than when the matrix is not diagonally dominant. The reason for this is that the diagonally dominant property ensures that the iteration scheme will consistently decrease the magnitude of the error in each iteration until the desired level of accuracy is reached.</p></li>
<li><p>When the matrix is not diagonally dominant, the iteration scheme may not consistently decrease the error in each iteration, and the convergence may be slow or even fail to converge.</p></li>
</ul>
</section>
</section>
</section>
<hr class="docutils" />
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">#</a></h2>
<p>In this lecture, we introduced vectors, matrices, and operations defined on these objects. Vectors and matrices are widely used in computer science, engineering, and other fields where mathematical modeling is essential.</p>
<p>We began our discussion of vectors, matrices, and their associated operations by quickly reviewing mass and mole balance equations:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#content-references-matrix-vector-mass-mol-balances"><span class="std std-ref">Review of balances</span></a>. Chemical Engineers use balance equations to describe, design, and troubleshoot products and processes. Balance equations describe the amount of <em>stuff</em> (e.g., mass, moles, energy, etc.) in a <em>system</em> that interacts with its <em>surroundings</em>. Balance equations can be represented as a system of matrices and vectors.</p></li>
</ul>
<p>We then transitioned to defining the structure of matrices and vectors and their associated operations:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#content-references-matrix-vector"><span class="std std-ref">Matricies and Vectors</span></a> are abstract mathematical objects, typically arrays of numbers, in engineering applications. Vectors (one-dimensional arrays) often describe points in space or encode coefficients of linear equations. On the other hand, matrices (two- or more dimensional objects) typically represent data sets or a grid of numbers. However, matrices also describe linear transformations, such as rotations and scaling operations, and define systems of linear equations.</p></li>
</ul>
<p>Finally, we considered a crucial application area, namely, the solution of systems of linear algebraic equations:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#content-references-soln-laes-start"><span class="std std-ref">Linear algebraic equations</span></a> arise in many different Engineering fields. In Chemical Engineering, these equations naturally arise from steady-state balance equations. We’ll introduce two approaches to solving these systems of equations.</p></li>
</ul>
</section>
<section id="additonal-resources">
<h2>Additonal resources<a class="headerlink" href="#additonal-resources" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>The matrix vector and matrix <span class="math notranslate nohighlight">\(\times\)</span> matrix product figures were inspired <a class="reference external" href="https://dzone.com/articles/visualizing-matrix">Visualizing Matrix Multiplication as a Linear Combination, Eli Bendersky, Apr. 12, 15 · Big Data Zone</a></p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "julia-1.8"
        },
        kernelOptions: {
            kernelName: "julia-1.8",
            path: "./unit-2-data"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'julia-1.8'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="trees.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Data Structures</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="reduction.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Dimensionality Reduction</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Varner<br/>
  
      &copy; Copyright 2023.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>