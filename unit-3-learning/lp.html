
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Linear Programming &#8212; CHEME 1800/4800</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="canonical" href="https://varnerlab.github.io/CHEME-1800-Computing-Book/landing.html/unit-3-learning/lp.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Combinatorial Optimization" href="combitorial.html" />
    <link rel="prev" title="Ordinary Least Squares Problems" href="penalty.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-VQRVBL1C02"></script>
<script>
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){ dataLayer.push(arguments); }
                    gtag('js', new Date());
                    gtag('config', 'G-VQRVBL1C02');
                </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/cornell_seal_simple_black.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">CHEME 1800/4800</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../landing.html">
                    Principles of Computational Thinking for Engineers
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../unit-1-basics/basics-landing.html">
   Unit 1. Basics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../unit-1-basics/types.html">
     Expressions, Variables and Types
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../unit-1-basics/functions.html">
     Functions, Control Statements, and Recursion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../unit-1-basics/programs.html">
     Programs and Modules
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../unit-1-basics/data-file-io.html">
     Data Input and Output
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../unit-2-data/data-landing.html">
   Unit 2. Data
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../unit-2-data/trees.html">
     Data Structures
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../unit-2-data/vectors-matricies-nla.html">
     Vectors, Matrices and Linear Algebraic Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../unit-2-data/reduction.html">
     Dimensionality Reduction
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="learning-landing.html">
   Unit 3. Learning
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="penalty.html">
     Ordinary Least Squares Problems
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Linear Programming
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="combitorial.html">
     Combinatorial Optimization
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../unit-4-decisions/decisions-landing.html">
   Unit 4. Decisions
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../unit-4-decisions/probability-random-variables.html">
     Probability, Random Variables and Stochastic Processes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../unit-4-decisions/mdp.html">
     Markov Decision Processes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../unit-4-decisions/multi-arm-bandits.html">
     Multiple Arm Bandit Problems and Reinforcement Learning
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../References.html">
   References
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/varnerlab/CHEME-1800-Computing-Book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/varnerlab/CHEME-1800-Computing-Book/issues/new?title=Issue%20on%20page%20%2Funit-3-learning/lp.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/unit-3-learning/lp.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#primal-linear-programs">
   Primal linear programs
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simplex-algorithm">
     Simplex algorithm
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#how-does-the-simplex-algorithm-work">
       How does the simplex algorithm work
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#aside-showing-up-late-is-not-always-bad">
       Aside: Showing up late is not always bad
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#general-resource-allocation-problem-structure">
     General resource allocation problem structure
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dual-linear-programs">
   Dual linear programs
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#duality-interpretation">
     Duality interpretation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#flux-balance-analysis">
   Flux balance analysis
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mole-based-fba-formulation">
     Mole-based FBA formulation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#additional-resources">
     Additional resources
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Linear Programming</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#primal-linear-programs">
   Primal linear programs
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simplex-algorithm">
     Simplex algorithm
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#how-does-the-simplex-algorithm-work">
       How does the simplex algorithm work
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#aside-showing-up-late-is-not-always-bad">
       Aside: Showing up late is not always bad
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#general-resource-allocation-problem-structure">
     General resource allocation problem structure
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dual-linear-programs">
   Dual linear programs
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#duality-interpretation">
     Duality interpretation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#flux-balance-analysis">
   Flux balance analysis
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mole-based-fba-formulation">
     Mole-based FBA formulation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#additional-resources">
     Additional resources
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="linear-programming">
<h1>Linear Programming<a class="headerlink" href="#linear-programming" title="Permalink to this headline">#</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h2>
<p>In this lecture, we’ll disucss linear programming.  Linear programming (LP) is a method to estimate the best outcome (such as maximum profit, lowest cost, or the best possible rate of production) using a mathematical model composed of linear relationships subject to linear constraints. Linear programming is widely used in business, economics, engineering, and other fields to model and solve real-world problems involving resource allocation, production planning, transportation, and more.</p>
<p>First, we’ll introduce the mathematical structure of linear programs, and then move to an important application area within chemical Engineering, namely flux balance analysis:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#content-references-primal-linear-problem"><span class="std std-ref">Primal linear programs</span></a> are a type of linear programming problem in which the goal is to maximize or minimize a linear objective function subject to a set of linear constraints in the form of inequalities or equalities. The term primal refers to the original form of the linear programming problem, as opposed to its dual form.</p></li>
<li><p><a class="reference internal" href="#content-references-dual-linear-problem"><span class="std std-ref">Dual linear programs</span></a> are formulations derived from a primal linear program that provides an alternative way of looking at the same problem. The dual linear program is constructed by introducing a set of new variables and constraints that are related to the primal linear program. The objective of the dual program is to either maximize or minimize a function, subject to a different set of constraints, which are derived from the original primal program.</p></li>
<li><p><a class="reference internal" href="#content-references-flux-balance-analysis"><span class="std std-ref">Flux balance analysis</span></a> is a general tool that can be used to estimate <em>flows</em> through many different types of networks and graphs, e.g., social graphs, communication networks, or other types of problems that can be represented as a network of graphs. Flux balance analysis can be implemented as a linear program.</p></li>
</ul>
<hr class="docutils" />
</section>
<section id="primal-linear-programs">
<span id="content-references-primal-linear-problem"></span><h2>Primal linear programs<a class="headerlink" href="#primal-linear-programs" title="Permalink to this headline">#</a></h2>
<p>Linear programs maximize (or minimize) a <em>linear</em> objective function <span class="math notranslate nohighlight">\(\mathcal{O}\)</span> subject to <em>linear</em> constraints and bounds on the decision variables <span class="math notranslate nohighlight">\(x\)</span> we are searching over. Decision variables can be continuous values <span class="math notranslate nohighlight">\(x\in\mathbb{R}\)</span>, but they can also be integers, e.g., <span class="math notranslate nohighlight">\(x\in{0,1}\)</span>. We’ll start with the continuous problem (<a class="reference internal" href="#defn-primael-linear program">Definition 40</a>):</p>
<div class="proof definition admonition" id="defn-primael-linear program">
<p class="admonition-title"><span class="caption-number">Definition 40 </span> (Primal Linear Program)</p>
<section class="definition-content" id="proof-content">
<p>Let <span class="math notranslate nohighlight">\(\mathcal{O}\)</span> denote a linear function of continuous decision variables <span class="math notranslate nohighlight">\(\mathbf{x}\in\mathbb{R}^{m}\)</span> whose values are constrained by a system of linear equations with system matrix <span class="math notranslate nohighlight">\(\mathbf{A}\in\mathbb{R}^{n\times{m}}\)</span>, and bounded. Then, we can estimate the <em>optimal</em> value for the variables <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> by solving the linear program (canonical form):</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\text{maximize}~\mathcal{O} &amp;=&amp; \sum_{i=1}^{m} c_{i}x_{i}\\
\text{subject to}~\mathbf{Ax} &amp;\leq&amp;\mathbf{b}\\
\text{and}~x_{i}&amp;\geq&amp;{0}\qquad{i=1,2,\dots,m}
\end{eqnarray}
\end{split}\]</div>
<p>The components of <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> are the variables to be determined, <span class="math notranslate nohighlight">\(c_{i}\)</span> are constant coefficients in the <em>linear</em> objective function <span class="math notranslate nohighlight">\(\mathcal{O}\)</span>, <span class="math notranslate nohighlight">\(\mathbf{A}\in\mathbb{R}^{n\times{m}}\)</span> is the constraint matrix and <span class="math notranslate nohighlight">\(\mathbf{b}\in\mathbb{R}^{n}\)</span> is a constant vector.</p>
<p>Any linear program can be converted into this standard form.</p>
</section>
</div><p>The feasible solutions of a linear program form a <a class="reference external" href="https://en.wikipedia.org/wiki/Polyhedron">polyhedron</a>, and the solution of the objective function lies on <a class="reference external" href="https://en.wikipedia.org/wiki/Extreme_point">extreme points of the polyhedron</a>. Because of its general structure, linear programming provides a powerful tool for optimizing complex decision-making problems in various industries, allowing for better resource utilization, efficiency, and increased profitability.</p>
<section id="simplex-algorithm">
<h3>Simplex algorithm<a class="headerlink" href="#simplex-algorithm" title="Permalink to this headline">#</a></h3>
<p>Linear programs, even those with thousands of decisions variables, can be efficently solved using simple off-the-shelf hardware, e.g., your laptop using the <a class="reference external" href="https://optimization.cbe.cornell.edu/index.php?title=Simplex_algorithm">simplex algorithm</a>. The simplex algorithm is a widely-used algorithm to solve the Linear Programming (LP) optimization problems first developed by <a class="reference external" href="https://en.wikipedia.org/wiki/George_Dantzig">George Dantzig</a>.</p>
<section id="how-does-the-simplex-algorithm-work">
<h4>How does the simplex algorithm work<a class="headerlink" href="#how-does-the-simplex-algorithm-work" title="Permalink to this headline">#</a></h4>
<p>The <a class="reference external" href="https://optimization.cbe.cornell.edu/index.php?title=Simplex_algorithm">simplex algorithm</a> is an iterative procedure for solving linear programming problems. The basic idea behind the simplex algorithm is to start with an initial feasible solution (i.e., a point that satisfies all constraints) and then iteratively improve it by moving along the edges of the feasible region (i.e., the region defined by the constraints). At each iteration, the algorithm selects a non-basic variable (i.e., a variable not currently part of the solution). It determines whether increasing or decreasing it will improve the objective function. If such an improvement can be made, the algorithm swaps the non-basic variable into the solution and updates the values of the basic variables (i.e., the variables already part of the solution). The process is repeated until no further improvement can be made, at which point the algorithm terminates, and the current solution is deemed optimal.</p>
</section>
<section id="aside-showing-up-late-is-not-always-bad">
<h4>Aside: Showing up late is not always bad<a class="headerlink" href="#aside-showing-up-late-is-not-always-bad" title="Permalink to this headline">#</a></h4>
<p>As an aside, the <a class="reference external" href="https://optimization.cbe.cornell.edu/index.php?title=Simplex_algorithm">simplex algorithm</a> resulted from <a class="reference external" href="https://en.wikipedia.org/wiki/George_Dantzig">Dantzig</a> showing up late to class. In 1939, near the beginning of a class, <a class="reference external" href="https://en.wikipedia.org/wiki/Jerzy_Neyman">Professor Neyman</a>, an instructor for a course that <a class="reference external" href="https://en.wikipedia.org/wiki/George_Dantzig">Dantzig</a> was taking, wrote two problems on the blackboard. <a class="reference external" href="https://en.wikipedia.org/wiki/George_Dantzig">Dantzig</a> arrived late and assumed they were homework problems. According to <a class="reference external" href="https://en.wikipedia.org/wiki/George_Dantzig">Dantzig</a>, the problem set seemed more complicated than usual, but a few days later, he handed in solutions for both problems, believing that his assignment was late.</p>
<p>However, six weeks later, an excited <a class="reference external" href="https://en.wikipedia.org/wiki/Jerzy_Neyman">Professor Neyman</a> told <a class="reference external" href="https://en.wikipedia.org/wiki/George_Dantzig">Dantzig</a> that the homework problems he had solved by mistake were two of the most famous unsolved problems in statistics. The rest is history; <a class="reference external" href="https://en.wikipedia.org/wiki/George_Dantzig">Dantzig</a> got his Ph.D. in 1946 and then developed the simplex algorithm in 1947, and linear programming was born!</p>
<!-- [The development of the simplex algorithm](https://optimization.cbe.cornell.edu/index.php?title=Simplex_algorithm), an efficient approach for solving linear programs, has led to LPs being used to solve problems in many engineering applications and other diverse industries such as banking, education, forestry, energy, and logistics.  -->
<p>Let’s explore linear programming by doing a classic linear programming problem, namely the optimal allocation of a scarce resource (<a class="reference internal" href="#example-resource-allocation-primal">Example 24</a>):</p>
<div class="proof example dropdown admonition" id="example-resource-allocation-primal">
<p class="admonition-title"><span class="caption-number">Example 24 </span> (Product mix primal problem)</p>
<section class="example-content" id="proof-content">
<p>Consider a manufacturing facility that produces a mixture of five different chemical products <span class="math notranslate nohighlight">\(C_{i}\)</span> using four processes <span class="math notranslate nohighlight">\(P_{j}\)</span> weekly. The process yeilds for each product, and the profit for each product, are shown in the table:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>Process</p></th>
<th class="text-align:center head"><p>Capacity</p></th>
<th class="head"><p>C<span class="math notranslate nohighlight">\(_{1}\)</span></p></th>
<th class="head"><p>C<span class="math notranslate nohighlight">\(_{2}\)</span></p></th>
<th class="head"><p>C<span class="math notranslate nohighlight">\(_{3}\)</span></p></th>
<th class="head"><p>C<span class="math notranslate nohighlight">\(_{4}\)</span></p></th>
<th class="head"><p>C<span class="math notranslate nohighlight">\(_{5}\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>P<span class="math notranslate nohighlight">\(_{1}\)</span></p></td>
<td class="text-align:center"><p>160</p></td>
<td><p>1.2</p></td>
<td><p>1.3</p></td>
<td><p>0.7</p></td>
<td><p>0.0</p></td>
<td><p>0.5</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>P<span class="math notranslate nohighlight">\(_{2}\)</span></p></td>
<td class="text-align:center"><p>200</p></td>
<td><p>0.7</p></td>
<td><p>2.2</p></td>
<td><p>1.6</p></td>
<td><p>0.5</p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>P<span class="math notranslate nohighlight">\(_{3}\)</span></p></td>
<td class="text-align:center"><p>120</p></td>
<td><p>0.9</p></td>
<td><p>0.7</p></td>
<td><p>1.3</p></td>
<td><p>1.0</p></td>
<td><p>0.8</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>P<span class="math notranslate nohighlight">\(_{4}\)</span></p></td>
<td class="text-align:center"><p>280</p></td>
<td><p>1.4</p></td>
<td><p>2.8</p></td>
<td><p>0.5</p></td>
<td><p>1.2</p></td>
<td><p>0.6</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>Unit profit $</p></td>
<td class="text-align:center"><p>–</p></td>
<td><p>18</p></td>
<td><p>25</p></td>
<td><p>10</p></td>
<td><p>12</p></td>
<td><p>15</p></td>
</tr>
</tbody>
</table>
<p>Determine the optimum production quantities for the chemical products <span class="math notranslate nohighlight">\(C_{j}\)</span> to maximize the total profit.</p>
<p><strong>Solution</strong>: Let’s define the decision variables, the objective function, and the problem constraints, then solve the problem in <a class="reference external" href="https://julialang.org">Julia</a> using the <a class="reference external" href="https://jump.dev/JuMP.jl/stable/">JuMP</a> package and the <a class="reference external" href="https://github.com/jump-dev/GLPK.jl">GLPK</a> linear programming solver.</p>
<p>Let <span class="math notranslate nohighlight">\(x_{i}\geq{0}\)</span> denote the amount of compound <span class="math notranslate nohighlight">\(i\)</span> produced per week (decision variable). The objective function <span class="math notranslate nohighlight">\(\mathcal{O}\)</span>, which is to maximize profit, is then given by:</p>
<div class="math notranslate nohighlight">
\[\mathcal{O} = 18x_{1} + 25x_{2} + 10x_{3} + 12x_{4} + 15x_{5} \]</div>
<p>where the coefficients are the unit profit for each product. Each process is governed by feedstock constraints:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray}
P_{1} &amp; : &amp; 1.2x_{1}+1.3x_{2}+0.7x_{3}+0.0x_{4} + 0.5x_{5} &amp; \leq &amp; 160 \\
P_{2} &amp; : &amp; 0.7x_{1}+2.2x_{2}+1.6x_{3}+0.5x_{4} + 1.0x_{5} &amp; \leq &amp; 200 \\
P_{3} &amp; : &amp; 0.9x_{1}+0.7x_{2}+1.3x_{3}+1.0x_{4} + 0.8x_{5} &amp; \leq &amp; 120 \\
P_{4} &amp; : &amp; 1.4x_{1}+2.8x_{2}+0.5x_{3}+1.2x_{4} + 0.6x_{5} &amp; \leq &amp; 280 \\
\end{eqnarray}\end{split}\]</div>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># include -</span>
<span class="k">using</span> <span class="n">JuMP</span>
<span class="k">using</span> <span class="n">GLPK</span>
<span class="k">using</span> <span class="n">LinearAlgebra</span>

<span class="c"># setup some constants -</span>
<span class="n">number_of_products</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="n">number_of_processes</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>

<span class="c"># Setup the system A, b and c -</span>
<span class="c"># Define the system matrix -</span>
<span class="n">A</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mf">1.2</span> <span class="mf">1.3</span> <span class="mf">0.7</span> <span class="mf">0.0</span> <span class="mf">0.5</span> <span class="p">;</span>
    <span class="mf">0.7</span> <span class="mf">2.2</span> <span class="mf">1.6</span> <span class="mf">0.5</span> <span class="mf">1.0</span> <span class="p">;</span>
    <span class="mf">0.9</span> <span class="mf">0.7</span> <span class="mf">1.3</span> <span class="mf">1.0</span> <span class="mf">0.8</span> <span class="p">;</span>
    <span class="mf">1.4</span> <span class="mf">2.8</span> <span class="mf">0.5</span> <span class="mf">1.2</span> <span class="mf">0.6</span> <span class="p">;</span>
<span class="p">];</span>

<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">160</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">280</span><span class="p">];</span> <span class="c"># Setup the right hand side vector</span>
<span class="n">c_vector</span> <span class="o">=</span> <span class="p">[</span><span class="mf">18.0</span><span class="p">,</span><span class="mf">25.0</span><span class="p">,</span><span class="mf">10.0</span><span class="p">,</span><span class="mf">12.0</span><span class="p">,</span><span class="mf">15.0</span><span class="p">];</span> <span class="c"># profits for each product</span>

<span class="c"># build a model -</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">GLPK</span><span class="o">.</span><span class="n">Optimizer</span><span class="p">)</span>

<span class="c"># add decision variables to the model -</span>
<span class="nd">@variable</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="o">:</span><span class="n">number_of_products</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="c"># this sets up 5 variables</span>

<span class="c"># Set the objective =&gt; maximize profit</span>
<span class="nd">@objective</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">Max</span><span class="p">,</span> <span class="n">transpose</span><span class="p">(</span><span class="n">c_vector</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="p">);</span>

<span class="c"># Setup the constraints - add them to the model </span>
<span class="nd">@constraints</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> 
    <span class="k">begin</span>
        <span class="n">A</span><span class="o">*</span><span class="n">x</span> <span class="o">.&lt;=</span> <span class="n">b</span>
    <span class="k">end</span>
<span class="p">);</span>

<span class="c"># solve the model</span>
<span class="n">optimize!</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">solution_summary</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="c"># show the solution</span>
<span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="o">:</span><span class="n">number_of_products</span>
    <span class="n">println</span><span class="p">(</span><span class="s">&quot;C</span><span class="si">$i</span><span class="s"> = &quot;</span><span class="p">,</span><span class="n">value</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="s">&quot; units per week.&quot;</span><span class="p">)</span>
<span class="k">end</span>

<span class="c"># print objective value -</span>
<span class="n">println</span><span class="p">(</span><span class="s">&quot;Objective value for the primal is: &quot;</span><span class="p">,</span> <span class="n">objective_value</span><span class="p">(</span><span class="n">model</span><span class="p">),</span> <span class="s">&quot; </span><span class="se">\$</span><span class="s"> per week&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The maximum profit per week: $2988.72 per week.</p>
<p><strong>Source</strong>: <a class="reference external" href="https://github.com/varnerlab/CHEME-1800-4800-Course-Repository-S23/tree/main/examples/unit-3-examples/resource_allocation_primal_lp">Unit 3 examples, CHEME-1800 GitHub repository</a>.</p>
</section>
</div></section>
</section>
<section id="general-resource-allocation-problem-structure">
<span id="content-references-resource-allocation-linear-problem"></span><h3>General resource allocation problem structure<a class="headerlink" href="#general-resource-allocation-problem-structure" title="Permalink to this headline">#</a></h3>
<p>The classic application of linear programming, as shown in (<a class="reference internal" href="#example-resource-allocation-primal">Example 24</a>), is to solve optimal resource allocation problems. However, before we discuss duality, which was typically described in economic terms, let’s look at the general form of a resource allocation problem (<a class="reference internal" href="#defn-general-resource-allocation-struct">Definition 41</a>):</p>
<div class="proof definition admonition" id="defn-general-resource-allocation-struct">
<p class="admonition-title"><span class="caption-number">Definition 41 </span> (Resource allocation problem structure)</p>
<section class="definition-content" id="proof-content">
<p>In a general resource allocation problem, we optimally allocate <span class="math notranslate nohighlight">\(n\)</span> scarce resources, e.g., time, money, etc., to <span class="math notranslate nohighlight">\(m\)</span> competing activities. This type of problem can be posed and solved as a linear problem of the form:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\text{maximize}~\mathcal{O} &amp;=&amp; \sum_{j=1}^{m} c_{j}x_{j}\\
\text{subject to}~\sum_{j=1}^{m}a_{ij}x_{j} &amp;\leq &amp; {b}_{i}\qquad{i=1,2,\dots,n}\\
\text{and}~x_{i}&amp;\geq&amp;{0}\qquad{i=1,2,\dots,m}
\end{eqnarray}
\end{split}\]</div>
<p>where the components of the problem now have particular meanings:</p>
<ul class="simple">
<li><p>The decision variables <span class="math notranslate nohighlight">\(\left\{x_{i}\right\}_{i=1}^{m}\)</span> represent the amount of activity <span class="math notranslate nohighlight">\(i\)</span>, of <span class="math notranslate nohighlight">\(m\)</span> possible activities, that we allocate.</p></li>
<li><p>Elements of the constraint matrix <span class="math notranslate nohighlight">\(\mathbf{A}\in\mathbb{R}^{n\times{m}}\)</span> describe the amount of resource <span class="math notranslate nohighlight">\(i\)</span>  consumed by a unit of activity <span class="math notranslate nohighlight">\(j\)</span>.</p></li>
<li><p>The right hand side elements <span class="math notranslate nohighlight">\(b_{i}\)</span> describe the amount of resource <span class="math notranslate nohighlight">\(i\)</span> that is available to be allocated.</p></li>
<li><p>The terms <span class="math notranslate nohighlight">\(c_{j}\)</span> describe the payoff experienced by doing a unit of activity <span class="math notranslate nohighlight">\(j\)</span>.</p></li>
</ul>
<p>This problem structure is highly adaptable and widely used for various applications.</p>
</section>
</div></section>
</section>
<section id="dual-linear-programs">
<span id="content-references-dual-linear-problem"></span><h2>Dual linear programs<a class="headerlink" href="#dual-linear-programs" title="Permalink to this headline">#</a></h2>
<p>The dual linear program, derived from the primal program, is an alternative way of looking at the same problem (<a class="reference internal" href="#defn-dual-linear program">Definition 42</a>). The dual linear program (LP) is derived from the original (the primal problem) using the scheme:</p>
<ul class="simple">
<li><p>Each variable in the primal linear program becomes a constraint in the dual linear program, each constraint in the primal linear program becomes a variable in the dual linear program, and the objective direction is inverted – the maximum in the primal becomes the minimum in the dual, and vice versa.</p></li>
</ul>
<div class="proof definition admonition" id="defn-dual-linear program">
<p class="admonition-title"><span class="caption-number">Definition 42 </span> (Dual linear program)</p>
<section class="definition-content" id="proof-content">
<p>Let <span class="math notranslate nohighlight">\(\mathcal{O}^{\prime}\)</span> denote a linear function of continuous decision variables <span class="math notranslate nohighlight">\(\mathbf{y}\in\mathbb{R}^{n}\)</span> whose values are constrained by a system of linear equations, and bounded. Then, we can estimate the <em>optimal</em> value for the variables <span class="math notranslate nohighlight">\(\mathbf{y}\)</span> of the dual problem by solving the linear program:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\text{minimize}~\mathcal{O}^{\prime} &amp;=&amp; \sum_{i=1}^{n} b_{i}y_{i}\\
\text{subject to}~\mathbf{A}^{T}\mathbf{y} &amp;\geq&amp;\mathbf{c}\\
\text{and}~y_{i}&amp;\geq&amp;{0}\qquad{i=1,2,\dots,n}
\end{eqnarray}
\end{split}\]</div>
<p><strong>Differences between the primal and the dual problems</strong>: The vectors <span class="math notranslate nohighlight">\(\mathbf{c}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> switch places, where the
<span class="math notranslate nohighlight">\(c_{j}\)</span> coefficients become the right-hand side vector in the dual, while the <span class="math notranslate nohighlight">\(b_{i}\)</span> are now in the objective function. Finally, the less than or equal to constraints in the primal problem become greater than or equal to constraints in the dual problem.</p>
<p>Every primal linear programming problem can be converted into its dual problem, which provides an upper bound to the optimal value of the primal problem.</p>
</section>
</div><section id="duality-interpretation">
<h3>Duality interpretation<a class="headerlink" href="#duality-interpretation" title="Permalink to this headline">#</a></h3>
<p>If we interpret the primal linear program as a classical resource allocation problem, then its dual can be interpreted as a resource valuation problem. Thus, the duality theorem has an economic interpretation:</p>
<ul class="simple">
<li><p>The primal problem in <a class="reference internal" href="#example-resource-allocation-primal">Example 24</a> deals with physical quantities, i.e., with production capacity (inputs) available in limited quantities, and with the quantities of products (outputs) that should be produced to maximize total revenue.</p></li>
<li><p>On the other hand, the dual problem deals with economic values. With floor guarantees on all chemical product (output) unit prices, and assuming the available quantity of all inputs (production capacity) is known, the dual problem computes the input unit pricing scheme that minimizes the total expenditure.</p></li>
</ul>
<p>To explore this interpretation, let’s formulate and solve the dual of the resource allocation problem above (<a class="reference internal" href="#example-resource-allocation-dual">Example 25</a>):</p>
<div class="proof example dropdown admonition" id="example-resource-allocation-dual">
<p class="admonition-title"><span class="caption-number">Example 25 </span> (Product mix dual problem)</p>
<section class="example-content" id="proof-content">
<p>Consider another facility with no chemical process manufacturing capacity that instead wishes to purchase the production capacity of the previous factory. In this case, the dual decision variables <span class="math notranslate nohighlight">\(y_{i}\)</span> are the offer prices per unit capacity.  For the offer to be accepted, <span class="math notranslate nohighlight">\(\mathbf{A}^{T}\mathbf{y}\geq\mathbf{c}\)</span>, i.e., facility one makes at least as much by selling the capacity as they do by manufacturing the chemical products.</p>
<p>The dual of <a class="reference internal" href="#example-resource-allocation-primal">Example 24</a>, which computes the capacity prices <span class="math notranslate nohighlight">\(y_{i}\)</span>, can be solved as:</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># include </span>
<span class="k">using</span> <span class="n">JuMP</span>
<span class="k">using</span> <span class="n">GLPK</span>
<span class="k">using</span> <span class="n">LinearAlgebra</span>

<span class="c"># setup some constants -</span>
<span class="n">number_of_products</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="n">number_of_processes</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>

<span class="c"># Setuo system -</span>
<span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="mf">18.0</span><span class="p">,</span><span class="mf">25.0</span><span class="p">,</span><span class="mf">10.0</span><span class="p">,</span><span class="mf">12.0</span><span class="p">,</span><span class="mf">15.0</span><span class="p">];</span> <span class="c"># profits for each product</span>

<span class="c"># System constraint matrix</span>
<span class="n">A</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mf">1.2</span> <span class="mf">1.3</span> <span class="mf">0.7</span> <span class="mf">0.0</span> <span class="mf">0.5</span> <span class="p">;</span>
    <span class="mf">0.7</span> <span class="mf">2.2</span> <span class="mf">1.6</span> <span class="mf">0.5</span> <span class="mf">1.0</span> <span class="p">;</span>
    <span class="mf">0.9</span> <span class="mf">0.7</span> <span class="mf">1.3</span> <span class="mf">1.0</span> <span class="mf">0.8</span> <span class="p">;</span>
    <span class="mf">1.4</span> <span class="mf">2.8</span> <span class="mf">0.5</span> <span class="mf">1.2</span> <span class="mf">0.6</span> <span class="p">;</span>
<span class="p">];</span>

<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">160</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">280</span><span class="p">];</span> <span class="c"># Setup the right hand side vector</span>

<span class="c"># build a model -</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">GLPK</span><span class="o">.</span><span class="n">Optimizer</span><span class="p">)</span>

<span class="c"># add decision variables to the model -</span>
<span class="nd">@variable</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="o">:</span><span class="n">number_of_processes</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="c"># this sets up 5 variables</span>

<span class="c"># Set the objective =&gt; maximize the profit -</span>
<span class="nd">@objective</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">Min</span><span class="p">,</span> <span class="n">transpose</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="p">);</span>

<span class="c"># Setup the constraints - add them to the model </span>
<span class="nd">@constraints</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> 
    <span class="k">begin</span>
        <span class="n">transpose</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">*</span><span class="n">y</span> <span class="o">.&gt;=</span> <span class="n">c</span> <span class="c"># what is the .&gt;= doing?</span>
    <span class="k">end</span>
<span class="p">);</span>

<span class="c"># solve the model</span>
<span class="n">optimize!</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">solution_summary</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="c"># show the solution</span>
<span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="o">:</span><span class="n">number_of_processes</span>
    <span class="n">println</span><span class="p">(</span><span class="s">&quot;y</span><span class="si">$i</span><span class="s"> = &quot;</span><span class="p">,</span><span class="n">value</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="s">&quot; units per week.&quot;</span><span class="p">)</span>
<span class="k">end</span>

<span class="c"># print objective value -</span>
<span class="n">println</span><span class="p">(</span><span class="s">&quot;Objective value for the dual is: &quot;</span><span class="p">,</span> <span class="n">objective_value</span><span class="p">(</span><span class="n">model</span><span class="p">))</span>
</pre></div>
</div>
<p>The objective value of the dual problem is: $2988.72 per week</p>
<p><strong>Source</strong>: <a class="reference external" href="https://github.com/varnerlab/CHEME-1800-4800-Course-Repository-S23/tree/main/examples/unit-3-examples/resource_allocation_primal_lp">Unit 3 examples, CHEME-1800 GitHub repository</a>.</p>
</section>
</div></section>
</section>
<section id="flux-balance-analysis">
<span id="content-references-flux-balance-analysis"></span><h2>Flux balance analysis<a class="headerlink" href="#flux-balance-analysis" title="Permalink to this headline">#</a></h2>
<p>Flux balance analysis (FBA) is an approach to estimate <em>flows</em> through <a class="reference internal" href="../unit-2-data/trees.html"><span class="doc std std-doc">trees and graphs</span></a>, e.g., social graphs, communication networks, or other structures that can be represented as a network. Flux balance analysis is a type of a <a class="reference external" href="https://en.wikipedia.org/wiki/Maximum_flow_problem">maximum flow problem</a>.</p>
<section id="mole-based-fba-formulation">
<h3>Mole-based FBA formulation<a class="headerlink" href="#mole-based-fba-formulation" title="Permalink to this headline">#</a></h3>
<p>In chemical engineering, flux balance analysis estimates chemical reaction rates (called <em>fluxes</em>) operating in <em>steady-state</em> reaction networks. The standard flux balance analysis problem is written in concentration units, e.g., the reaction flux has units of mmol/volume-time. However, sometimes it is more convenient to work in mole units instead. We know from our <a class="reference internal" href="../unit-2-data/vectors-matricies-nla.html"><span class="doc std std-doc">earlier discussion of material balances</span></a> that the open species mole balance around component <span class="math notranslate nohighlight">\(i\)</span> in a steady-state system with species <span class="math notranslate nohighlight">\(\mathcal{M}\)</span>, streams <span class="math notranslate nohighlight">\(\mathcal{S}\)</span> and reactions <span class="math notranslate nohighlight">\(\mathcal{R}\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[\sum_{s\in\mathcal{S}}v_{s}\dot{n}_{is} + \sum_{j\in\mathcal{R}}\sigma_{ij}\dot{\epsilon}_{j} = 0\qquad\forall{i}\in\mathcal{M}\]</div>
<p>If we don’t have <a class="reference external" href="https://en.wikipedia.org/wiki/Rate_equation">kinetic rate laws</a>, or we are not approaching this problem from the <a class="reference external" href="https://en.wikipedia.org/wiki/Chemical_equilibrium">equilibrium or energy perspective</a>, then we need some other way to estimate the extent of reaction <span class="math notranslate nohighlight">\(\dot{\epsilon}_{j}\)</span>, consider <a class="reference internal" href="#obs-simple-mole-based case">Observation 8</a>:</p>
<div class="proof observation admonition" id="obs-simple-mole-based case">
<p class="admonition-title"><span class="caption-number">Observation 8 </span> (Mole based problem formulation)</p>
<section class="observation-content" id="proof-content">
<p>Suppose we have an open steady-state system with species <span class="math notranslate nohighlight">\(\mathcal{M}\)</span>, streams <span class="math notranslate nohighlight">\(\mathcal{S}\)</span> and reactions <span class="math notranslate nohighlight">\(\mathcal{R}\)</span>, but qith only a single stream entering (s = 1) and exiting (s = 2) the system. Further, suppose we want to maximize/minimize an objective of the form:</p>
<div class="math notranslate nohighlight">
\[\text{maximize/minimze}~\mathcal{O}=\sum_{i\in\mathcal{R}}c_{i}\dot{\epsilon}_{i}\]</div>
<p>In other words, we want to estimate the open extent such that some <em>technological</em> objective is met, e.g., we maximize the production of a valuable product. For the case of a single input and output, the open mole balance becomes:</p>
<div class="math notranslate nohighlight">
\[\dot{n}_{i,2} = \dot{n}_{i,1} + \sum_{j\in\mathcal{R}}\sigma_{ij}\dot{\epsilon}_{j}\qquad\forall{i}\in\mathcal{M}\]</div>
<p>Of course, when searching for the optimal set of reaction extents <span class="math notranslate nohighlight">\(\dot{\epsilon}_{j}\)</span> we have to select values that give physically realistic answers, e.g., we can’t have a negative mole flow rates: <span class="math notranslate nohighlight">\(\dot{n}_{i,j}\geq{0}\)</span> for all <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span>. Thus, the species mole balances are linear constraints governing  the open extent:</p>
<div class="math notranslate nohighlight">
\[\dot{n}_{i,1} + \sum_{j\in\mathcal{R}}\sigma_{ij}\dot{\epsilon}_{j}\geq{0}\qquad\forall{i}\in\mathcal{M}\]</div>
<p>Next, the <span class="math notranslate nohighlight">\(\dot{\epsilon}_{j}\)</span> terms must be bounded, i.e., we can’t have infinite values for the open reaction extent, nor can irreversible reactions be chosen to run backward. Thus, the extents are <em>bounded</em> from above and below:</p>
<div class="math notranslate nohighlight">
\[\mathcal{L}_{j}\leq\dot{\epsilon}_{j}\leq\mathcal{U}_{j}\qquad{j=1,2\dots,\mathcal{R}}\]</div>
<p>The <span class="math notranslate nohighlight">\(\mathcal{L}_{j}\)</span> and <span class="math notranslate nohighlight">\(\mathcal{U}_{j}\)</span> denote the lower and upper bounds that <span class="math notranslate nohighlight">\(\dot{\epsilon}_{j}\)</span> can take. Open extents <span class="math notranslate nohighlight">\(\dot{\epsilon}_{j}\)</span> are just reaction rates times the volume; the lower and upper bounds describe the permissible range we expect the rate <em>could</em> take.</p>
</section>
</div><p>Putting these ideas together for the general case of multiple input and output streams gives a general problem formulation to compute the flux through a reaction network using mole based units (<a class="reference internal" href="#defn-mol-based-units">Definition 43</a>):</p>
<div class="proof definition admonition" id="defn-mol-based-units">
<p class="admonition-title"><span class="caption-number">Definition 43 </span> (Mole based flux problem)</p>
<section class="definition-content" id="proof-content">
<p>We have an open system with species <span class="math notranslate nohighlight">\(\mathcal{M}\)</span>, streams <span class="math notranslate nohighlight">\(\mathcal{S}\)</span>, and reactions <span class="math notranslate nohighlight">\(\mathcal{R}\)</span>. Further, we partition the stream set <span class="math notranslate nohighlight">\(\mathcal{S}\)</span> into streams entering the system <span class="math notranslate nohighlight">\(\mathcal{S}^{+}\)</span>, and streams leaving the system <span class="math notranslate nohighlight">\(\mathcal{S}^{-}\)</span>.  Then, the steady-state species mole balances are given by:</p>
<div class="math notranslate nohighlight">
\[\sum_{s\in\mathcal{S}^{+}}\dot{n}_{is} - \sum_{k\in\mathcal{S}^{-}}\dot{n}_{ik} + \sum_{j\in\mathcal{R}}\sigma_{ij}\dot{\epsilon}_{j} = 0\qquad\forall{i}\in\mathcal{M}\]</div>
<p>Finally, <span class="math notranslate nohighlight">\(\dot{n}_{i,j}\geq{0}\)</span> for every <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span>; species mole flows must be non-negative. Then, the (unknown) open extents <span class="math notranslate nohighlight">\(\dot{\epsilon}_{j}\)</span> are the solution of a linear programming problem in which the linear objective <span class="math notranslate nohighlight">\(\mathcal{O}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\text{maximize/minimize}~\mathcal{O} = \sum_{j\in\mathcal{R}}c_{j}\dot{\epsilon}_{j}\]</div>
<p>is minimized (or maximized) subject to the linear constraints:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray}
\sum_{j\in\mathcal{R}}\sigma_{ij}\dot{\epsilon}_{j}&amp;\geq&amp;{-\sum_{s\in\mathcal{S}^{+}}\dot{n}_{si}}\qquad\forall{i}\in\mathcal{M}\\
\sum_{k\in\mathcal{S}^{-}}\dot{n}_{ki}&amp;\geq&amp;{0}\qquad\forall{i}\in\mathcal{M}\\
\mathcal{L}_{j}&amp;\leq\dot{\epsilon}_{j}\leq&amp;\mathcal{U}_{j}\qquad\forall{j}\in\mathcal{R}
\end{eqnarray}\end{split}\]</div>
</section>
</div></section>
</section>
<hr class="docutils" />
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">#</a></h2>
<p>In this lecture, we disucssed linear programming (LP).  Linear programming is a method to estimate the best outcome (such as maximum profit, lowest cost, or the best possible rate of production) using a mathematical model composed of linear relationships subject to linear constraints. Linear programming is widely used in business, economics, engineering, and other fields to model and solve real-world problems involving resource allocation, production planning, transportation, and more.</p>
<p>First, we introduced the mathematical structure of linear programs, the dual problem, and then moved to an important application area within chemical Engineering, namely flux balance analysis:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#content-references-primal-linear-problem"><span class="std std-ref">Primal linear programs</span></a> are a type of linear programming problem in which the goal is to maximize or minimize a linear objective function subject to a set of linear constraints in the form of inequalities or equalities. The term primal refers to the original form of the linear programming problem, as opposed to its dual form.</p></li>
<li><p><a class="reference internal" href="#content-references-dual-linear-problem"><span class="std std-ref">Dual linear programs</span></a> are formulations derived from a primal linear program that provides an alternative way of looking at the same problem. The dual linear program is constructed by introducing a set of new variables and constraints that are related to the primal linear program. The objective of the dual program is to either maximize or minimize a function, subject to a different set of constraints, which are derived from the original primal program.</p></li>
<li><p><a class="reference internal" href="#content-references-flux-balance-analysis"><span class="std std-ref">Flux balance analysis</span></a> is a general tool that can be used to estimate <em>flows</em> through many different types of networks and graphs, e.g., social graphs, communication networks, or other types of problems that can be represented as a network of graphs. Flux balance analysis can be implemented as a linear program.</p></li>
</ul>
<section id="additional-resources">
<h3>Additional resources<a class="headerlink" href="#additional-resources" title="Permalink to this headline">#</a></h3>
<p>Background resources for biochemical network information, and computational tools for working with flux balance analysis models:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.genome.jp/kegg/">Kanehisa M, Goto S. KEGG: kyoto encyclopedia of genes and genomes. Nucleic Acids Res. 2000 Jan 1;28(1):27-30. doi: 10.1093/nar/28.1.27. PMID: 10592173; PMCID: PMC102409.</a></p></li>
<li><p><a class="reference external" href="https://pubmed.ncbi.nlm.nih.gov/29447345/">Karp, Peter D et al. “The BioCyc collection of microbial genomes and metabolic pathways.” Briefings in bioinformatics vol. 20,4 (2019): 1085-1093. doi:10.1093/bib/bbx085</a></p></li>
<li><p><a class="reference external" href="https://pubmed.ncbi.nlm.nih.gov/26527724/">Gama-Castro, Socorro et al. “RegulonDB version 9.0: high-level integration of gene regulation, coexpression, motif clustering and beyond.” Nucleic acids research vol. 44,D1 (2016): D133-43. doi:10.1093/nar/gkv1156</a></p></li>
<li><p><a class="reference external" href="https://pubmed.ncbi.nlm.nih.gov/30787451/">Heirendt, Laurent et al. “Creation and analysis of biochemical constraint-based models using the COBRA Toolbox v.3.0.” Nature protocols vol. 14,3 (2019): 639-702. doi:10.1038/s41596-018-0098-2</a></p></li>
</ul>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./unit-3-learning"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="penalty.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Ordinary Least Squares Problems</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="combitorial.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Combinatorial Optimization</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Varner<br/>
  
      &copy; Copyright 2023.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>